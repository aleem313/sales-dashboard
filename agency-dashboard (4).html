<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Agency Analytics</title>
<link href="https://fonts.googleapis.com/css2?family=Instrument+Sans:wght@400;500;600;700&family=DM+Mono:wght@300;400;500&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #f4f5f7;
  --white: #ffffff;
  --border: #e3e6ec;
  --border-light: #eef0f4;
  --text-primary: #0f1923;
  --text-secondary: #5a6478;
  --text-muted: #96a1b5;
  --accent: #1a56db;
  --accent-light: #eff4ff;
  --accent-mid: #c7d8fc;
  --green: #0d7a4e;
  --green-light: #ecfdf5;
  --green-mid: #a7f3d0;
  --amber: #92400e;
  --amber-light: #fffbeb;
  --amber-mid: #fcd34d;
  --red: #991b1b;
  --red-light: #fef2f2;
  --red-mid: #fca5a5;
  --purple: #5b21b6;
  --purple-light: #f5f3ff;
  --shadow-sm: 0 1px 3px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04);
  --shadow: 0 4px 12px rgba(0,0,0,0.07), 0 1px 3px rgba(0,0,0,0.04);
  --radius: 10px;
}

/* ── DARK MODE ── */
[data-theme="dark"] {
  --bg: #0f1117;
  --white: #181c25;
  --border: #252d3d;
  --border-light: #1e2535;
  --text-primary: #e8edf5;
  --text-secondary: #8a97ae;
  --text-muted: #4e5a70;
  --accent: #4d8af0;
  --accent-light: #1a2540;
  --accent-mid: #253658;
  --green: #34d399;
  --green-light: #0d2a1f;
  --green-mid: #134e35;
  --amber: #fbbf24;
  --amber-light: #27200d;
  --amber-mid: #3d2f0d;
  --red: #f87171;
  --red-light: #2a1414;
  --red-mid: #3d1f1f;
  --purple: #a78bfa;
  --purple-light: #1e1535;
  --shadow-sm: 0 1px 3px rgba(0,0,0,0.3), 0 1px 2px rgba(0,0,0,0.2);
  --shadow: 0 4px 16px rgba(0,0,0,0.4), 0 1px 4px rgba(0,0,0,0.3);
}
[data-theme="dark"] .kpi-value.green { color: #34d399; }
[data-theme="dark"] .kpi-value.amber { color: #fbbf24; }
[data-theme="dark"] .kpi-value.red   { color: #f87171; }
[data-theme="dark"] .metric-val.good { color: #34d399; }
[data-theme="dark"] .metric-val.warn { color: #fbbf24; }
[data-theme="dark"] .metric-val.bad  { color: #f87171; }
[data-theme="dark"] .kpi-up          { color: #34d399; }
[data-theme="dark"] .kpi-down        { color: #f87171; }
[data-theme="dark"] .chip-green { background: var(--green-light); color: #34d399; }
[data-theme="dark"] .chip-amber { background: var(--amber-light); color: #fbbf24; }
[data-theme="dark"] .chip-red   { background: var(--red-light);   color: #f87171; }
[data-theme="dark"] .chip-purple{ background: var(--purple-light); color: #a78bfa; }
[data-theme="dark"] .progress-fill { opacity: 0.85; }
[data-theme="dark"] .funnel-fill   { opacity: 0.9; }
[data-theme="dark"] .p-cell { background: #141820; }
[data-theme="dark"] .pf-card:hover,
[data-theme="dark"] .kpi-card:hover { box-shadow: var(--shadow); }

/* ── THEME TOGGLE BUTTON ── */
.theme-toggle {
  width: 36px; height: 36px;
  border-radius: 8px;
  border: 1px solid var(--border);
  background: var(--bg);
  color: var(--text-secondary);
  display: flex; align-items: center; justify-content: center;
  cursor: pointer;
  transition: all 0.15s;
  flex-shrink: 0;
}
.theme-toggle:hover { background: var(--white); color: var(--text-primary); border-color: var(--accent); }
.theme-toggle svg { width: 16px; height: 16px; transition: transform 0.3s ease; }
.theme-toggle:hover svg { transform: rotate(20deg); }
.icon-sun, .icon-moon { display: none; }
[data-theme="light"] .icon-sun  { display: block; }
[data-theme="dark"]  .icon-moon { display: block; }
html:not([data-theme]) .icon-sun { display: block; }
* { margin: 0; padding: 0; box-sizing: border-box; }
body, .sidebar, .topbar, .card, .kpi-card, .agent-card, .pf-card, .p-cell, .nav-item, .btn, .theme-toggle {
  transition: background-color 0.2s ease, border-color 0.2s ease, color 0.2s ease, box-shadow 0.2s ease;
}
body { background: var(--bg); color: var(--text-primary); font-family: 'Instrument Sans', sans-serif; font-size: 14px; line-height: 1.5; min-height: 100vh; }
.app { display: flex; height: 100vh; }

/* SIDEBAR */
.sidebar { width: 232px; flex-shrink: 0; background: var(--white); border-right: 1px solid var(--border); display: flex; flex-direction: column; overflow-y: auto; }
.logo-area { padding: 20px 20px 16px; border-bottom: 1px solid var(--border-light); }
.logo-mark { display: flex; align-items: center; gap: 10px; }
.logo-icon { width: 30px; height: 30px; background: var(--accent); border-radius: 7px; display: flex; align-items: center; justify-content: center; }
.logo-text { font-size: 15px; font-weight: 700; color: var(--text-primary); letter-spacing: -0.02em; }
.logo-sub { font-size: 11px; color: var(--text-muted); margin-top: 6px; }
.nav { padding: 12px 10px; flex: 1; }
.nav-group { margin-bottom: 4px; }
.nav-group-label { font-size: 10.5px; font-weight: 600; color: var(--text-muted); letter-spacing: 0.08em; text-transform: uppercase; padding: 8px 10px 4px; }
.nav-item { display: flex; align-items: center; gap: 9px; padding: 8px 10px; border-radius: 7px; font-size: 13.5px; font-weight: 500; color: var(--text-secondary); cursor: pointer; transition: all 0.12s; }
.nav-item:hover { color: var(--text-primary); background: var(--bg); }
.nav-item.active { color: var(--accent); background: var(--accent-light); font-weight: 600; }
.nav-icon { width: 16px; height: 16px; flex-shrink: 0; opacity: 0.6; }
.nav-item.active .nav-icon { opacity: 1; }
.nav-badge { margin-left: auto; font-size: 10px; font-weight: 600; background: var(--red-light); color: var(--red); padding: 1px 6px; border-radius: 10px; }
.sidebar-footer { padding: 14px 20px; border-top: 1px solid var(--border-light); }
.status-row { display: flex; align-items: center; gap: 7px; font-size: 12px; color: var(--text-muted); }
.status-dot { width: 7px; height: 7px; border-radius: 50%; background: #22c55e; animation: pulse 2.5s ease-in-out infinite; flex-shrink: 0; }
@keyframes pulse { 0%,100%{box-shadow:0 0 0 0 rgba(34,197,94,0.4);} 50%{box-shadow:0 0 0 4px rgba(34,197,94,0);} }

/* MAIN */
.main { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
.topbar { background: var(--white); border-bottom: 1px solid var(--border); padding: 0 28px; height: 58px; display: flex; align-items: center; justify-content: space-between; flex-shrink: 0; }
.page-heading { display: flex; align-items: baseline; gap: 10px; }
.page-title { font-size: 16px; font-weight: 700; color: var(--text-primary); letter-spacing: -0.02em; }
.page-crumb { font-size: 12px; color: var(--text-muted); }
.topbar-actions { display: flex; align-items: center; gap: 8px; }
.btn { display: inline-flex; align-items: center; gap: 5px; padding: 6px 14px; border-radius: 7px; font-size: 12.5px; font-weight: 600; cursor: pointer; transition: all 0.12s; border: 1px solid transparent; font-family: inherit; }
.btn-ghost { color: var(--text-secondary); background: transparent; border-color: var(--border); }
.btn-ghost:hover { background: var(--bg); color: var(--text-primary); }
.btn-ghost.active { background: var(--accent-light); color: var(--accent); border-color: var(--accent-mid); }
.divider-v { width: 1px; height: 20px; background: var(--border); }
.content { flex: 1; overflow-y: auto; padding: 24px 28px 32px; }

/* PANELS */
.panel { display: none; }
.panel.active { display: block; animation: fadeUp 0.2s ease both; }
@keyframes fadeUp { from{opacity:0;transform:translateY(8px);} to{opacity:1;transform:translateY(0);} }

/* KPI ROW */
.kpi-row { display: grid; grid-template-columns: repeat(5,1fr); gap: 14px; margin-bottom: 20px; }
.kpi-card { background: var(--white); border: 1px solid var(--border); border-radius: var(--radius); padding: 18px 20px; box-shadow: var(--shadow-sm); transition: box-shadow 0.15s; }
.kpi-card:hover { box-shadow: var(--shadow); }
.kpi-label { font-size: 11px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.07em; margin-bottom: 8px; }
.kpi-value { font-size: 28px; font-weight: 700; color: var(--text-primary); letter-spacing: -0.03em; line-height: 1; }
.kpi-value.blue{color:var(--accent);} .kpi-value.green{color:#059669;} .kpi-value.amber{color:#d97706;} .kpi-value.red{color:#dc2626;}
.kpi-footer { margin-top: 8px; font-size: 11.5px; color: var(--text-muted); }
.kpi-up{color:#059669;font-weight:600;} .kpi-down{color:#dc2626;font-weight:600;}

/* GRIDS */
.g2 { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 20px; }
.g3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; margin-bottom: 20px; }
.g3-1 { display: grid; grid-template-columns: 2fr 1fr; gap: 16px; margin-bottom: 20px; }

/* CARD */
.card { background: var(--white); border: 1px solid var(--border); border-radius: var(--radius); box-shadow: var(--shadow-sm); overflow: hidden; }
.card-head { padding: 14px 20px; border-bottom: 1px solid var(--border-light); display: flex; align-items: center; justify-content: space-between; }
.card-title { font-size: 13.5px; font-weight: 700; color: var(--text-primary); letter-spacing: -0.01em; }
.card-sub { font-size: 11.5px; color: var(--text-muted); margin-top: 1px; }
.chip { display: inline-flex; align-items: center; padding: 3px 9px; border-radius: 20px; font-size: 11px; font-weight: 600; letter-spacing: 0.02em; }
.chip-blue{background:var(--accent-light);color:var(--accent);} .chip-green{background:var(--green-light);color:#059669;} .chip-amber{background:var(--amber-light);color:#b45309;} .chip-red{background:var(--red-light);color:var(--red);} .chip-muted{background:var(--bg);color:var(--text-muted);} .chip-purple{background:var(--purple-light);color:var(--purple);}

/* TABLE */
.tbl { width: 100%; border-collapse: collapse; }
.tbl thead tr { border-bottom: 1px solid var(--border); }
.tbl th { padding: 10px 16px; font-size: 11px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.07em; text-align: left; white-space: nowrap; }
.tbl td { padding: 11px 16px; font-size: 13px; color: var(--text-primary); border-bottom: 1px solid var(--border-light); }
.tbl tr:last-child td { border-bottom: none; }
.tbl tbody tr:hover td { background: var(--bg); }

/* FUNNEL */
.funnel { display: flex; flex-direction: column; gap: 10px; }
.funnel-row { display: grid; grid-template-columns: 130px 1fr 42px; align-items: center; gap: 12px; }
.funnel-label { font-size: 12.5px; color: var(--text-secondary); font-weight: 500; }
.funnel-track { height: 22px; background: var(--bg); border-radius: 4px; overflow: hidden; }
.funnel-fill { height: 100%; border-radius: 4px; display: flex; align-items: center; padding-left: 8px; font-size: 11px; font-weight: 600; color: white; min-width: 28px; }
.funnel-num { font-size: 12px; font-weight: 600; color: var(--text-secondary); text-align: right; font-family: 'DM Mono', monospace; }

/* PIPELINE */
.pipeline-grid { display: grid; grid-template-columns: repeat(6,1fr); gap: 10px; margin-bottom: 10px; }
.p-cell { background: var(--bg); border: 1px solid var(--border); border-radius: 8px; padding: 14px; border-top: 3px solid; }
.p-cell.c-blue{border-top-color:var(--accent);} .p-cell.c-green{border-top-color:#22c55e;} .p-cell.c-amber{border-top-color:#f59e0b;} .p-cell.c-red{border-top-color:#ef4444;} .p-cell.c-gray{border-top-color:#94a3b8;}
.p-label { font-size: 10.5px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.07em; margin-bottom: 6px; }
.p-num { font-size: 26px; font-weight: 700; letter-spacing: -0.03em; line-height: 1; }
.p-sub { font-size: 11px; color: var(--text-muted); margin-top: 4px; }

/* AGENT CARD */
.agent-card { background: var(--white); border: 1px solid var(--border); border-radius: var(--radius); box-shadow: var(--shadow-sm); overflow: hidden; }
.agent-header { padding: 16px 20px; display: flex; align-items: center; gap: 12px; border-bottom: 1px solid var(--border-light); }
.avatar { width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 13px; font-weight: 700; flex-shrink: 0; color: white; }
.av-blue{background:#1a56db;} .av-green{background:#059669;} .av-amber{background:#d97706;}
.agent-name { font-size: 14px; font-weight: 700; color: var(--text-primary); letter-spacing: -0.01em; }
.agent-role { font-size: 11.5px; color: var(--text-muted); }
.agent-body { padding: 16px 20px; }
.agent-kpi-row { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; margin-bottom: 16px; }
.agent-kpi { text-align: center; padding: 10px; background: var(--bg); border-radius: 7px; }
.agent-kpi-val { font-size: 20px; font-weight: 700; letter-spacing: -0.02em; line-height: 1; }
.agent-kpi-lbl { font-size: 10px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.07em; margin-top: 3px; }
.metric-row { display: flex; justify-content: space-between; align-items: center; padding: 7px 0; border-bottom: 1px solid var(--border-light); font-size: 12.5px; }
.metric-row:last-child { border-bottom: none; }
.metric-key { color: var(--text-muted); font-weight: 500; }
.metric-val { font-weight: 600; color: var(--text-primary); font-family: 'DM Mono', monospace; font-size: 12px; }
.metric-val.good{color:#059669;} .metric-val.warn{color:#d97706;} .metric-val.bad{color:#dc2626;}

/* PROFILE GRID */
.profile-grid { display: grid; grid-template-columns: repeat(5,1fr); gap: 12px; }
.pf-card { background: var(--white); border: 1px solid var(--border); border-radius: var(--radius); padding: 16px; box-shadow: var(--shadow-sm); transition: box-shadow 0.15s, transform 0.15s; }
.pf-card:hover { box-shadow: var(--shadow); transform: translateY(-1px); }
.pf-rank { font-size: 10px; font-weight: 700; color: var(--text-muted); letter-spacing: 0.1em; text-transform: uppercase; margin-bottom: 4px; }
.pf-name { font-size: 14px; font-weight: 700; color: var(--text-primary); margin-bottom: 2px; letter-spacing: -0.01em; }
.pf-niche { font-size: 11px; color: var(--text-muted); margin-bottom: 12px; }
.pf-stat-row { display: flex; justify-content: space-between; font-size: 12px; margin-bottom: 5px; }
.pf-stat-key { color: var(--text-muted); }
.pf-stat-val { font-weight: 600; font-family: 'DM Mono', monospace; font-size: 11.5px; }
.progress-bar { height: 4px; background: var(--border); border-radius: 2px; margin-top: 10px; overflow: hidden; }
.progress-fill { height: 100%; border-radius: 2px; }

/* ALERTS */
.alert-item { display: flex; gap: 13px; padding: 14px 18px; border-radius: 8px; margin-bottom: 10px; border: 1px solid; }
.alert-critical{background:var(--red-light);border-color:var(--red-mid);} .alert-warning{background:var(--amber-light);border-color:var(--amber-mid);} .alert-success{background:var(--green-light);border-color:var(--green-mid);} .alert-info{background:var(--accent-light);border-color:var(--accent-mid);}
.alert-icon { width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; font-size: 13px; }
.ai-red{background:var(--red-mid);} .ai-amber{background:var(--amber-mid);} .ai-green{background:var(--green-mid);} .ai-blue{background:var(--accent-mid);}
.alert-title { font-size: 13px; font-weight: 700; color: var(--text-primary); margin-bottom: 3px; }
.alert-body { font-size: 12px; color: var(--text-secondary); line-height: 1.5; }

/* SCROLLBAR */
::-webkit-scrollbar{width:5px;height:5px;} ::-webkit-scrollbar-track{background:transparent;} ::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px;}

/* ══ DATE RANGE PICKER ══ */
.drp-trigger { font-size: 12.5px; gap: 7px; padding: 7px 14px; white-space: nowrap; }
.drp-trigger.open { background: var(--accent-light); color: var(--accent); border-color: var(--accent-mid); }

.drp-overlay {
  display: none;
  position: fixed;
  inset: 0;
  z-index: 999;
}
.drp-overlay.open { display: block; }

.drp-popup {
  position: absolute;
  top: 62px;
  right: 28px;
  width: 740px;
  background: var(--white);
  border: 1px solid var(--border);
  border-radius: 12px;
  box-shadow: 0 12px 40px rgba(0,0,0,0.14), 0 2px 8px rgba(0,0,0,0.06);
  display: flex;
  overflow: hidden;
  z-index: 1000;
  animation: popIn 0.15s ease both;
}
@keyframes popIn { from{opacity:0;transform:translateY(-6px) scale(0.98);} to{opacity:1;transform:translateY(0) scale(1);} }

/* Presets */
.drp-presets {
  width: 180px;
  flex-shrink: 0;
  border-right: 1px solid var(--border);
  padding: 16px 0;
  overflow-y: auto;
  max-height: 480px;
}
.drp-presets-title { font-size: 10.5px; font-weight: 700; color: var(--text-muted); letter-spacing: 0.1em; text-transform: uppercase; padding: 4px 16px 8px; }
.drp-preset-sep { height: 1px; background: var(--border-light); margin: 6px 0; }
.drp-preset {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 16px;
  font-size: 13px;
  color: var(--text-secondary);
  cursor: pointer;
  transition: background 0.1s;
}
.drp-preset:hover { background: var(--bg); color: var(--text-primary); }
.drp-preset.selected { color: var(--accent); font-weight: 600; }
.drp-radio {
  width: 16px; height: 16px; border-radius: 50%;
  border: 2px solid var(--border);
  flex-shrink: 0;
  display: flex; align-items: center; justify-content: center;
  transition: border-color 0.1s;
}
.drp-preset.selected .drp-radio { border-color: var(--accent); background: var(--accent); }
.drp-preset.selected .drp-radio::after { content:''; width:6px; height:6px; border-radius:50%; background:white; display:block; }

/* Calendar area */
.drp-right { flex: 1; display: flex; flex-direction: column; }

.drp-calendars {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 0;
  padding: 16px 20px 12px;
  border-bottom: 1px solid var(--border-light);
}

.drp-cal { }
.drp-cal-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 12px;
}
.drp-cal-nav {
  width: 26px; height: 26px;
  border-radius: 6px;
  border: 1px solid var(--border);
  background: transparent;
  color: var(--text-secondary);
  cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  font-size: 14px;
  transition: all 0.1s;
  font-family: inherit;
}
.drp-cal-nav:hover { background: var(--bg); color: var(--text-primary); }
.drp-cal-nav.hidden { visibility: hidden; }
.drp-cal-month-year {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 13.5px;
  font-weight: 700;
  color: var(--text-primary);
}
.drp-cal-select {
  background: transparent;
  border: none;
  font-family: inherit;
  font-size: 13.5px;
  font-weight: 700;
  color: var(--text-primary);
  cursor: pointer;
  padding: 2px 4px;
  border-radius: 4px;
  appearance: none;
  -webkit-appearance: none;
}
.drp-cal-select:focus { outline: 2px solid var(--accent-mid); }
[data-theme="dark"] .drp-cal-select { background: var(--white); }
.drp-sel-wrap { position: relative; display: inline-flex; align-items: center; }
.drp-sel-wrap::after { content:'▾'; font-size:10px; color:var(--text-muted); margin-left:1px; pointer-events:none; }

.drp-grid { width: 100%; border-collapse: collapse; }
.drp-grid th { font-size: 11px; font-weight: 600; color: var(--text-muted); text-align: center; padding: 4px 0 6px; }
.drp-grid td {
  text-align: center;
  padding: 2px;
  font-size: 12.5px;
  color: var(--text-primary);
}
.drp-day {
  width: 30px; height: 30px;
  border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  cursor: pointer;
  margin: 0 auto;
  transition: background 0.1s, color 0.1s;
  font-size: 12.5px;
  user-select: none;
}
.drp-day:hover:not(.empty):not(.disabled) { background: var(--accent-light); color: var(--accent); }
.drp-day.disabled { color: var(--border); cursor: default; }
.drp-day.empty { cursor: default; }
.drp-day.in-range { background: var(--accent-light); color: var(--accent); border-radius: 0; }
td:first-child .drp-day.in-range { border-radius: 50% 0 0 50%; }
td:last-child .drp-day.in-range { border-radius: 0 50% 50% 0; }
.drp-day.range-start, .drp-day.range-end { background: var(--accent) !important; color: white !important; border-radius: 50% !important; }
.drp-day.today { font-weight: 700; }
.drp-day.today:not(.range-start):not(.range-end):not(.in-range) { color: var(--accent); }

/* Footer */
.drp-footer {
  padding: 12px 20px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
}
.drp-inputs { display: flex; align-items: center; gap: 8px; }
.drp-input {
  padding: 6px 10px;
  border: 1px solid var(--border);
  border-radius: 7px;
  font-family: 'DM Mono', monospace;
  font-size: 12px;
  color: var(--text-primary);
  background: var(--bg);
  width: 120px;
  transition: border-color 0.1s;
}
.drp-input:focus { outline: none; border-color: var(--accent); }
[data-theme="dark"] .drp-input { background: var(--bg); color: var(--text-primary); }
.drp-sep { color: var(--text-muted); font-size: 13px; }
.drp-actions { display: flex; gap: 8px; }
.drp-btn-cancel {
  padding: 7px 16px; border-radius: 7px; border: 1px solid var(--border);
  background: transparent; color: var(--text-secondary); font-family: inherit;
  font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.1s;
}
.drp-btn-cancel:hover { background: var(--bg); color: var(--text-primary); }
.drp-btn-update {
  padding: 7px 18px; border-radius: 7px; border: none;
  background: var(--accent); color: white; font-family: inherit;
  font-size: 13px; font-weight: 600; cursor: pointer; transition: background 0.1s;
}
.drp-btn-update:hover { filter: brightness(1.1); }
.drp-tz { font-size: 11px; color: var(--text-muted); }


/* ══ LIVE JOB FEED ══ */
.feed-layout { display: grid; grid-template-columns: 1fr 320px; gap: 16px; align-items: start; }

.feed-list { display: flex; flex-direction: column; gap: 0; }

.feed-item {
  background: var(--white);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 16px 18px;
  margin-bottom: 10px;
  display: flex;
  gap: 14px;
  align-items: flex-start;
  transition: box-shadow 0.15s, transform 0.15s;
  cursor: pointer;
  position: relative;
  overflow: hidden;
}
.feed-item:hover { box-shadow: var(--shadow); transform: translateY(-1px); }
.feed-item.new-item {
  animation: feedSlideIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) both;
  border-color: var(--accent-mid);
}
@keyframes feedSlideIn {
  from { opacity: 0; transform: translateY(-12px) scale(0.98); }
  to   { opacity: 1; transform: translateY(0) scale(1); }
}
.feed-item.accepted { border-left: 3px solid #059669; }
.feed-item.rejected { border-left: 3px solid #dc2626; opacity: 0.5; }
.feed-item.pending  { border-left: 3px solid var(--accent); }

.feed-new-pulse {
  position: absolute;
  top: 14px; right: 14px;
  width: 8px; height: 8px;
  border-radius: 50%;
  background: var(--accent);
  animation: feedPulse 1.5s ease infinite;
}
@keyframes feedPulse {
  0%,100% { box-shadow: 0 0 0 0 rgba(26,86,219,0.4); }
  50%      { box-shadow: 0 0 0 5px rgba(26,86,219,0); }
}

.feed-score-ring {
  width: 44px; height: 44px; flex-shrink: 0;
  border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-size: 13px; font-weight: 800;
  font-family: 'DM Mono', monospace;
  position: relative;
}
.feed-score-ring svg { position: absolute; inset: 0; transform: rotate(-90deg); }
.feed-score-ring span { position: relative; z-index: 1; }

.feed-body { flex: 1; min-width: 0; }
.feed-title { font-size: 14px; font-weight: 700; color: var(--text-primary); margin-bottom: 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.feed-meta { display: flex; align-items: center; gap: 8px; flex-wrap: wrap; margin-bottom: 8px; }
.feed-meta-item { font-size: 11.5px; color: var(--text-muted); display: flex; align-items: center; gap: 3px; }
.feed-meta-item strong { color: var(--text-secondary); font-weight: 600; }
.feed-tags { display: flex; gap: 5px; flex-wrap: wrap; margin-bottom: 10px; }
.feed-tag { font-size: 10.5px; padding: 2px 8px; border-radius: 4px; background: var(--bg); color: var(--text-secondary); border: 1px solid var(--border); font-weight: 500; }
.feed-snippet { font-size: 12px; color: var(--text-muted); line-height: 1.5; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }

.feed-actions { display: flex; flex-direction: column; align-items: flex-end; gap: 8px; flex-shrink: 0; }
.feed-time { font-size: 11px; color: var(--text-muted); font-family: 'DM Mono', monospace; white-space: nowrap; }
.feed-action-row { display: flex; gap: 6px; }
.feed-btn {
  padding: 5px 12px; border-radius: 6px; font-size: 11.5px; font-weight: 600;
  cursor: pointer; transition: all 0.1s; border: 1px solid; font-family: inherit;
}
.feed-btn-accept { background: var(--green-light); color: #059669; border-color: var(--green-mid); }
.feed-btn-accept:hover { background: #d1fae5; }
.feed-btn-reject { background: var(--red-light); color: var(--red); border-color: var(--red-mid); }
.feed-btn-reject:hover { background: #fee2e2; }
.feed-btn-view { background: var(--accent-light); color: var(--accent); border-color: var(--accent-mid); }
.feed-btn-view:hover { background: #dbeafe; }

/* Feed sidebar */
.feed-sidebar { display: flex; flex-direction: column; gap: 12px; position: sticky; top: 0; }

.feed-stat-mini {
  background: var(--white); border: 1px solid var(--border); border-radius: var(--radius);
  padding: 14px 16px; box-shadow: var(--shadow-sm);
}
.feed-stat-mini-label { font-size: 10.5px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.07em; margin-bottom: 6px; }
.feed-stat-mini-val { font-size: 24px; font-weight: 700; letter-spacing: -0.03em; color: var(--text-primary); line-height: 1; }
.feed-stat-mini-sub { font-size: 11.5px; color: var(--text-muted); margin-top: 5px; }

.feed-ticker {
  background: var(--white); border: 1px solid var(--border); border-radius: var(--radius);
  overflow: hidden; box-shadow: var(--shadow-sm);
}
.feed-ticker-head { padding: 12px 14px; border-bottom: 1px solid var(--border-light); display: flex; align-items: center; justify-content: space-between; }
.feed-ticker-title { font-size: 13px; font-weight: 700; color: var(--text-primary); }
.feed-ticker-body { max-height: 280px; overflow-y: auto; }
.feed-ticker-row {
  display: flex; align-items: center; gap: 10px;
  padding: 10px 14px; border-bottom: 1px solid var(--border-light); font-size: 12px;
  animation: fadeUp 0.3s ease both;
}
.feed-ticker-row:last-child { border-bottom: none; }
.feed-ticker-dot { width: 7px; height: 7px; border-radius: 50%; flex-shrink: 0; }
.feed-ticker-text { flex: 1; color: var(--text-secondary); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.feed-ticker-time { font-size: 10.5px; color: var(--text-muted); font-family: 'DM Mono', monospace; flex-shrink: 0; }

.feed-profile-match {
  background: var(--white); border: 1px solid var(--border); border-radius: var(--radius);
  padding: 14px 16px; box-shadow: var(--shadow-sm);
}
.feed-pm-title { font-size: 13px; font-weight: 700; color: var(--text-primary); margin-bottom: 12px; }
.feed-pm-row { display: flex; align-items: center; gap: 10px; margin-bottom: 8px; }
.feed-pm-name { font-size: 12px; font-weight: 600; color: var(--text-primary); flex: 1; }
.feed-pm-bar-wrap { width: 80px; height: 6px; background: var(--border); border-radius: 3px; overflow: hidden; }
.feed-pm-bar { height: 100%; border-radius: 3px; background: var(--accent); }
.feed-pm-pct { font-size: 11px; font-family: 'DM Mono', monospace; color: var(--text-muted); width: 30px; text-align: right; }

/* Paused/playing state */
.feed-controls { display: flex; align-items: center; gap: 8px; }
.feed-pause-btn {
  padding: 4px 10px; border-radius: 6px; font-size: 11px; font-weight: 600;
  border: 1px solid var(--border); background: transparent; cursor: pointer;
  color: var(--text-secondary); font-family: inherit; transition: all 0.1s;
}
.feed-pause-btn:hover { background: var(--bg); }
.feed-pause-btn.paused { background: var(--amber-light); color: #b45309; border-color: var(--amber-mid); }


/* ══ DASHBOARD FILTERS ══ */
.filter-bar {
  display: flex;
  align-items: center;
  gap: 8px;
}
.filter-select-wrap {
  position: relative;
  display: inline-flex;
  align-items: center;
}
.filter-select-wrap .filter-icon {
  position: absolute;
  left: 10px;
  pointer-events: none;
  color: var(--text-muted);
  width: 14px; height: 14px;
}
.filter-select {
  appearance: none;
  -webkit-appearance: none;
  padding: 6px 30px 6px 30px;
  border: 1px solid var(--border);
  border-radius: 7px;
  font-family: 'Instrument Sans', sans-serif;
  font-size: 12.5px;
  font-weight: 600;
  color: var(--text-secondary);
  background: transparent;
  cursor: pointer;
  transition: all 0.12s;
  min-width: 130px;
}
.filter-select:hover { border-color: var(--accent); color: var(--text-primary); }
.filter-select:focus { outline: none; border-color: var(--accent); color: var(--text-primary); }
.filter-select.active-filter { background: var(--accent-light); color: var(--accent); border-color: var(--accent-mid); }
[data-theme="dark"] .filter-select { background: transparent; color: var(--text-secondary); }
[data-theme="dark"] .filter-select.active-filter { background: var(--accent-light); }
.filter-select-wrap .filter-caret {
  position: absolute;
  right: 9px;
  pointer-events: none;
  color: var(--text-muted);
  font-size: 10px;
}
.filter-active-bar {
  display: none;
  align-items: center;
  gap: 8px;
  padding: 7px 14px;
  background: var(--accent-light);
  border-bottom: 1px solid var(--accent-mid);
  font-size: 12px;
  color: var(--accent);
  font-weight: 500;
}
.filter-active-bar.show { display: flex; }
.filter-active-chip {
  display: inline-flex;
  align-items: center;
  gap: 5px;
  padding: 2px 8px 2px 10px;
  background: white;
  border: 1px solid var(--accent-mid);
  border-radius: 20px;
  font-size: 11.5px;
  font-weight: 600;
  color: var(--accent);
  cursor: pointer;
}
[data-theme="dark"] .filter-active-chip { background: var(--white); }
.filter-active-chip:hover { background: var(--bg); }
.filter-active-chip .x { font-size: 13px; line-height: 1; opacity: 0.6; margin-left: 2px; }
.filter-active-chip .x:hover { opacity: 1; }
.filter-clear-all {
  font-size: 11.5px;
  color: var(--text-muted);
  cursor: pointer;
  text-decoration: underline;
  margin-left: 4px;
}
.filter-clear-all:hover { color: var(--accent); }

</style>
</head>
<body>
<div class="app">

<aside class="sidebar">
  <div class="logo-area">
    <div class="logo-mark">
      <div class="logo-icon">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
      </div>
      <div class="logo-text">AgencyOS</div>
    </div>
    <div class="logo-sub">10 profiles · 3 agents</div>
  </div>
  <nav class="nav">
    <div class="nav-group">
      <div class="nav-group-label">Overview</div>
      <div class="nav-item active" onclick="setTab('overview','Dashboard',this)">
        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>
        Dashboard
      </div>
      <div class="nav-item" onclick="setTab('funnel','Pipeline',this)">
        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 3H2l8 9.46V19l4 2V12.46z"/></svg>
        Pipeline
      </div>
    </div>
    <div class="nav-group">
      <div class="nav-group-label">Performance</div>
      <div class="nav-item" onclick="setTab('agents','Agents',this)">
        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"/></svg>
        Agents
      </div>
      <div class="nav-item" onclick="setTab('profiles','Profiles',this)">
        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="8" r="5"/><path d="M3 21v-1a7 7 0 0 1 14 0v1"/></svg>
        Profiles
      </div>
    </div>
    <div class="nav-group">
      <div class="nav-group-label">Resources</div>
      <div class="nav-item" onclick="setTab('connects','Connect Efficiency',this)">
        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
        Connects
      </div>
      <div class="nav-item" onclick="setTab('alerts','Alerts & Insights',this)">
        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg>
        Alerts
        <span class="nav-badge">3</span>
      </div>
    </div>
    <div class="nav-group">
      <div class="nav-group-label">Live</div>
      <div class="nav-item" onclick="setTab('livefeed','Live Job Feed',this)">
        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="2"/><path d="M16.24 7.76a6 6 0 0 1 0 8.49m-8.48-.01a6 6 0 0 1 0-8.49m11.31-2.82a10 10 0 0 1 0 14.14m-14.14 0a10 10 0 0 1 0-14.14"/></svg>
        Job Feed
        <span class="nav-badge" id="feedBadge" style="background:var(--green-light);color:#059669;">0</span>
      </div>
    </div>
  </nav>
  <div class="sidebar-footer">
    <div class="status-row"><div class="status-dot"></div>All systems operational</div>
  </div>
</aside>

<div class="main">
  <div class="topbar">
    <div class="page-heading">
      <div class="page-title" id="page-title">Dashboard</div>
      <div class="page-crumb">Updated just now</div>
    </div>
    <div class="topbar-actions">
      <div class="filter-bar" id="filterBar">
        <!-- Agent filter -->
        <div class="filter-select-wrap">
          <svg class="filter-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"/></svg>
          <select class="filter-select" id="agentFilter" onchange="applyFilters()">
            <option value="">All Agents</option>
            <option value="ahmed">Ahmed K.</option>
            <option value="sara">Sara R.</option>
            <option value="mike">Mike J.</option>
          </select>
          <span class="filter-caret">▾</span>
        </div>
        <!-- Profile filter -->
        <div class="filter-select-wrap">
          <svg class="filter-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="7" width="20" height="14" rx="2"/><path d="M16 3H8L6 7h12z"/></svg>
          <select class="filter-select" id="profileFilter" onchange="applyFilters()">
            <option value="">All Profiles</option>
            <option value="p1">Profile #1 · Design</option>
            <option value="p2">Profile #2 · Automation</option>
            <option value="p3">Profile #3 · SaaS Dev</option>
            <option value="p4">Profile #4 · Backend Dev</option>
            <option value="p5">Profile #5 · Full Stack</option>
            <option value="p6">Profile #6 · E-Commerce</option>
            <option value="p7">Profile #7 · AI/ML</option>
            <option value="p8">Profile #8 · Copywriting</option>
            <option value="p9">Profile #9 · No-Code</option>
            <option value="p10">Profile #10 · SEO</option>
          </select>
          <span class="filter-caret">▾</span>
        </div>
        <div class="divider-v"></div>
      </div>
      <button class="btn btn-ghost drp-trigger" id="drpTrigger" onclick="toggleDatePicker()">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
        <span id="drpLabel">Last 30 days: 28 Jan – 27 Feb 2026</span>
        <svg width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="6 9 12 15 18 9"/></svg>
      </button>
      <div class="divider-v"></div>
      <button class="btn btn-ghost">Export</button>
      <div class="divider-v"></div>
      <button class="theme-toggle" id="themeToggle" title="Toggle dark/light mode">
        <svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
        <svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
      </button>
    </div>
  </div>

  <!-- Active filter indicator bar -->
  <div class="filter-active-bar" id="filterActiveBar">
    <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 3H2l8 9.46V19l4 2V12.46z"/></svg>
    Filtered by:
    <span id="filterChips"></span>
    <span class="filter-clear-all" onclick="clearAllFilters()">Clear all</span>
  </div>

  <div class="content">

    <!-- OVERVIEW -->
    <div class="panel active" id="panel-overview">
      <div class="kpi-row">
        <div class="kpi-card"><div class="kpi-label">Jobs Received</div><div class="kpi-value blue" id="kpi-jobs-received">248</div><div class="kpi-footer" id="kpi-jobs-received-delta"><span class="kpi-up">↑ 34</span> vs last week</div></div>
        <div class="kpi-card"><div class="kpi-label">Proposals Sent</div><div class="kpi-value" id="kpi-proposals-sent">91</div><div class="kpi-footer" id="kpi-proposals-pass">36.7% pass rate</div></div>
        <div class="kpi-card"><div class="kpi-label">Meetings Booked</div><div class="kpi-value amber" id="kpi-meetings-booked">18</div><div class="kpi-footer" id="kpi-meetings-rate">19.8% booking rate</div></div>
        <div class="kpi-card"><div class="kpi-label">Jobs Won</div><div class="kpi-value green" id="kpi-jobs-won">6</div><div class="kpi-footer" id="kpi-jobs-won-delta"><span class="kpi-up">↑ 2</span> vs last week</div></div>
        <div class="kpi-card"><div class="kpi-label">Close Rate</div><div class="kpi-value blue" id="kpi-close-rate">33%</div><div class="kpi-footer">Meetings → Won</div></div>
      </div>

      <div class="g3-1">
        <div class="card">
          <div class="card-head"><div><div class="card-title">Conversion Funnel</div><div class="card-sub">End-to-end pipeline · this week</div></div><span class="chip chip-blue">Live</span></div>
          <div style="padding:20px;">
            <div class="funnel">
              <div class="funnel-row"><div class="funnel-label">Jobs Received</div><div class="funnel-track"><div class="funnel-fill" id="funnel-0" style="width:100%;background:#1a56db;">248</div></div><div class="funnel-num" id="funnel-0-num">248</div></div>
              <div class="funnel-row"><div class="funnel-label">Passed Filters</div><div class="funnel-track"><div class="funnel-fill" id="funnel-1" style="width:68%;background:#2563eb;">169</div></div><div class="funnel-num" id="funnel-1-num">169</div></div>
              <div class="funnel-row"><div class="funnel-label">Proposals Sent</div><div class="funnel-track"><div class="funnel-fill" id="funnel-2" style="width:37%;background:#7c3aed;">91</div></div><div class="funnel-num" id="funnel-2-num">91</div></div>
              <div class="funnel-row"><div class="funnel-label">Responses</div><div class="funnel-track"><div class="funnel-fill" id="funnel-3" style="width:16%;background:#8b5cf6;">40</div></div><div class="funnel-num" id="funnel-3-num">40</div></div>
              <div class="funnel-row"><div class="funnel-label">Meetings Done</div><div class="funnel-track"><div class="funnel-fill" id="funnel-4" style="width:8%;background:#d97706;">20</div></div><div class="funnel-num" id="funnel-4-num">20</div></div>
              <div class="funnel-row"><div class="funnel-label">Negotiation</div><div class="funnel-track"><div class="funnel-fill" id="funnel-5" style="width:5%;background:#ea580c;">12</div></div><div class="funnel-num" id="funnel-5-num">12</div></div>
              <div class="funnel-row"><div class="funnel-label">Won</div><div class="funnel-track"><div class="funnel-fill" id="funnel-6" style="width:2.5%;background:#059669;">6</div></div><div class="funnel-num" id="funnel-6-num">6</div></div>
            </div>
          </div>
        </div>
        <div style="display:flex;flex-direction:column;gap:16px;">
          <div class="card">
            <div class="card-head"><div class="card-title">Live Pipeline</div><span class="chip chip-amber">Active</span></div>
            <div style="padding:14px 16px;display:flex;flex-direction:column;gap:8px;">
              <div style="display:flex;justify-content:space-between;align-items:center;padding:9px 12px;background:var(--accent-light);border-radius:7px;border-left:3px solid var(--accent);">
                <span style="font-size:12.5px;color:var(--text-secondary);font-weight:500;">To Do</span>
                <span style="font-size:20px;font-weight:700;color:var(--accent);font-family:'DM Mono',monospace;" id="pl-todo">23</span>
              </div>
              <div style="display:flex;justify-content:space-between;align-items:center;padding:9px 12px;background:var(--purple-light);border-radius:7px;border-left:3px solid #7c3aed;">
                <span style="font-size:12.5px;color:var(--text-secondary);font-weight:500;">In Progress</span>
                <span style="font-size:20px;font-weight:700;color:#7c3aed;font-family:'DM Mono',monospace;" id="pl-inprogress">14</span>
              </div>
              <div style="display:flex;justify-content:space-between;align-items:center;padding:9px 12px;background:var(--amber-light);border-radius:7px;border-left:3px solid #d97706;">
                <span style="font-size:12.5px;color:var(--text-secondary);font-weight:500;">Meetings</span>
                <span style="font-size:20px;font-weight:700;color:#d97706;font-family:'DM Mono',monospace;" id="pl-meetings">5</span>
              </div>
              <div style="display:flex;justify-content:space-between;align-items:center;padding:9px 12px;background:var(--green-light);border-radius:7px;border-left:3px solid #059669;">
                <span style="font-size:12.5px;color:var(--text-secondary);font-weight:500;">Negotiation</span>
                <span style="font-size:20px;font-weight:700;color:#059669;font-family:'DM Mono',monospace;" id="pl-negotiation">3</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="g2">
        <div class="card">
          <div class="card-head"><div><div class="card-title">Top Profiles by Win Rate</div><div class="card-sub">This week</div></div><span class="chip chip-green">Ranked</span></div>
          <table class="tbl">
            <thead><tr><th>Profile</th><th>Niche</th><th>Proposals</th><th>Interview %</th><th>Won</th></tr></thead>
            <tbody id="top-profiles-tbody">
              <tr><td style="font-weight:700;">Profile #3</td><td><span class="chip chip-blue">SaaS Dev</span></td><td style="font-family:'DM Mono',monospace;">14</td><td style="color:#059669;font-weight:600;font-family:'DM Mono',monospace;">42%</td><td style="font-weight:700;color:#059669;font-family:'DM Mono',monospace;">3</td></tr>
              <tr><td style="font-weight:700;">Profile #7</td><td><span class="chip chip-purple">AI / ML</span></td><td style="font-family:'DM Mono',monospace;">11</td><td style="color:#059669;font-weight:600;font-family:'DM Mono',monospace;">36%</td><td style="font-weight:700;color:#059669;font-family:'DM Mono',monospace;">2</td></tr>
              <tr><td style="font-weight:700;">Profile #1</td><td><span class="chip chip-amber">Design</span></td><td style="font-family:'DM Mono',monospace;">18</td><td style="color:#d97706;font-weight:600;font-family:'DM Mono',monospace;">22%</td><td style="font-family:'DM Mono',monospace;font-weight:700;">1</td></tr>
              <tr><td style="font-weight:700;">Profile #9</td><td><span class="chip chip-muted">No-Code</span></td><td style="font-family:'DM Mono',monospace;">9</td><td style="color:#dc2626;font-weight:600;font-family:'DM Mono',monospace;">8%</td><td style="color:#dc2626;font-weight:700;font-family:'DM Mono',monospace;">0</td></tr>
            </tbody>
          </table>
        </div>
        <div class="card">
          <div class="card-head"><div><div class="card-title">Agent Leaderboard</div><div class="card-sub">This week</div></div></div>
          <div style="padding:4px 8px;" id="agent-leaderboard-body">
            <div style="display:flex;align-items:center;gap:12px;padding:12px 10px;border-bottom:1px solid var(--border-light);">
              <div style="font-size:11px;font-weight:700;color:var(--text-muted);width:18px;text-align:center;">#1</div>
              <div class="avatar av-blue">AK</div>
              <div style="flex:1;"><div style="font-size:13.5px;font-weight:700;">Ahmed K.</div><div style="font-size:11px;color:var(--text-muted);">SaaS + AI profiles</div></div>
              <div style="display:flex;gap:16px;">
                <div style="text-align:center;"><div style="font-size:16px;font-weight:700;color:var(--accent);font-family:'DM Mono',monospace;">31</div><div style="font-size:10px;color:var(--text-muted);text-transform:uppercase;letter-spacing:.05em;">Applied</div></div>
                <div style="text-align:center;"><div style="font-size:16px;font-weight:700;color:#d97706;font-family:'DM Mono',monospace;">8</div><div style="font-size:10px;color:var(--text-muted);text-transform:uppercase;letter-spacing:.05em;">Mtgs</div></div>
                <div style="text-align:center;"><div style="font-size:16px;font-weight:700;color:#059669;font-family:'DM Mono',monospace;">3</div><div style="font-size:10px;color:var(--text-muted);text-transform:uppercase;letter-spacing:.05em;">Won</div></div>
              </div>
            </div>
            <div style="display:flex;align-items:center;gap:12px;padding:12px 10px;border-bottom:1px solid var(--border-light);">
              <div style="font-size:11px;font-weight:700;color:var(--text-muted);width:18px;text-align:center;">#2</div>
              <div class="avatar av-green">SR</div>
              <div style="flex:1;"><div style="font-size:13.5px;font-weight:700;">Sara R.</div><div style="font-size:11px;color:var(--text-muted);">Design + Copy profiles</div></div>
              <div style="display:flex;gap:16px;">
                <div style="text-align:center;"><div style="font-size:16px;font-weight:700;color:var(--accent);font-family:'DM Mono',monospace;">28</div><div style="font-size:10px;color:var(--text-muted);text-transform:uppercase;letter-spacing:.05em;">Applied</div></div>
                <div style="text-align:center;"><div style="font-size:16px;font-weight:700;color:#d97706;font-family:'DM Mono',monospace;">6</div><div style="font-size:10px;color:var(--text-muted);text-transform:uppercase;letter-spacing:.05em;">Mtgs</div></div>
                <div style="text-align:center;"><div style="font-size:16px;font-weight:700;color:#059669;font-family:'DM Mono',monospace;">2</div><div style="font-size:10px;color:var(--text-muted);text-transform:uppercase;letter-spacing:.05em;">Won</div></div>
              </div>
            </div>
            <div style="display:flex;align-items:center;gap:12px;padding:12px 10px;">
              <div style="font-size:11px;font-weight:700;color:var(--text-muted);width:18px;text-align:center;">#3</div>
              <div class="avatar av-amber">MJ</div>
              <div style="flex:1;"><div style="font-size:13.5px;font-weight:700;">Mike J.</div><div style="font-size:11px;color:var(--text-muted);">Automation profiles</div></div>
              <div style="display:flex;gap:16px;">
                <div style="text-align:center;"><div style="font-size:16px;font-weight:700;color:var(--accent);font-family:'DM Mono',monospace;">19</div><div style="font-size:10px;color:var(--text-muted);text-transform:uppercase;letter-spacing:.05em;">Applied</div></div>
                <div style="text-align:center;"><div style="font-size:16px;font-weight:700;color:#d97706;font-family:'DM Mono',monospace;">4</div><div style="font-size:10px;color:var(--text-muted);text-transform:uppercase;letter-spacing:.05em;">Mtgs</div></div>
                <div style="text-align:center;"><div style="font-size:16px;font-weight:700;color:#dc2626;font-family:'DM Mono',monospace;">1</div><div style="font-size:10px;color:var(--text-muted);text-transform:uppercase;letter-spacing:.05em;">Won</div></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Live Job Feed Mini Table -->
      <div class="card" style="margin-bottom:20px;">
        <div class="card-head">
          <div>
            <div class="card-title">Live Job Feed</div>
            <div class="card-sub">Latest incoming jobs from Upwork via Vollna</div>
          </div>
          <div style="display:flex;align-items:center;gap:8px;">
            <div style="display:flex;align-items:center;gap:6px;font-size:12px;color:var(--text-muted);"><div class="status-dot"></div>Live</div>
            <button class="btn btn-ghost" style="font-size:11.5px;padding:5px 12px;" onclick="setTab('livefeed','Live Job Feed',document.querySelector('[onclick*=livefeed]'))">View all</button>
          </div>
        </div>
        <table class="tbl" id="overview-feed-table">
          <thead>
            <tr>
              <th>Job Title</th>
              <th>Budget</th>
              <th>Profile Match</th>
              <th>Client</th>
              <th>Score</th>
              <th>Received</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody id="overview-feed-tbody">
            <tr><td colspan="7" style="text-align:center;color:var(--text-muted);padding:24px;font-size:12px;">Waiting for jobs…</td></tr>
          </tbody>
        </table>
      </div>

    </div>

    <!-- PIPELINE -->
    <div class="panel" id="panel-funnel">
      <div class="kpi-row">
        <div class="kpi-card"><div class="kpi-label">To Do</div><div class="kpi-value blue" id="pipe-kpi-todo">23</div><div class="kpi-footer">Awaiting action</div></div>
        <div class="kpi-card"><div class="kpi-label">Submitted</div><div class="kpi-value" id="pipe-kpi-submitted">41</div><div class="kpi-footer">Awaiting response</div></div>
        <div class="kpi-card"><div class="kpi-label">Prototype Stage</div><div class="kpi-value amber" id="pipe-kpi-proto">8</div><div class="kpi-footer">3 pending delivery</div></div>
        <div class="kpi-card"><div class="kpi-label">Meeting Stage</div><div class="kpi-value" id="pipe-kpi-meeting">9</div><div class="kpi-footer">5 done · 4 scheduled</div></div>
        <div class="kpi-card"><div class="kpi-label">Negotiation</div><div class="kpi-value green" id="pipe-kpi-negotiation">3</div><div class="kpi-footer">High priority</div></div>
      </div>
      <div class="card" style="margin-bottom:20px;">
        <div class="card-head"><div class="card-title">Stage Overview</div><span class="chip chip-blue">All Profiles · Live</span></div>
        <div style="padding:16px;">
          <div class="pipeline-grid">
            <div class="p-cell c-blue"><div class="p-label">To Do</div><div class="p-num" style="color:var(--accent);">23</div><div class="p-sub">Needs proposal</div></div>
            <div class="p-cell c-gray"><div class="p-label">Submitted</div><div class="p-num">41</div><div class="p-sub">Awaiting client</div></div>
            <div class="p-cell c-amber"><div class="p-label">Proto Required</div><div class="p-num" style="color:#d97706;">5</div><div class="p-sub">Build needed</div></div>
            <div class="p-cell c-gray"><div class="p-label">Mtg Scheduled</div><div class="p-num">4</div><div class="p-sub">Calendar booked</div></div>
            <div class="p-cell c-blue"><div class="p-label">Negotiation</div><div class="p-num" style="color:var(--accent);">3</div><div class="p-sub">Hot leads</div></div>
            <div class="p-cell c-green"><div class="p-label">Won</div><div class="p-num" style="color:#059669;">6</div><div class="p-sub">This week</div></div>
          </div>
          <div class="pipeline-grid">
            <div class="p-cell c-gray"><div class="p-label">Proto Done</div><div class="p-num">3</div><div class="p-sub">Ready to send</div></div>
            <div class="p-cell c-gray"><div class="p-label">Proto Submitted</div><div class="p-num">2</div><div class="p-sub">Awaiting feedback</div></div>
            <div class="p-cell c-gray"><div class="p-label">Mtg Done</div><div class="p-num">5</div><div class="p-sub">Follow up needed</div></div>
            <div class="p-cell c-red"><div class="p-label">Lost</div><div class="p-num" style="color:#dc2626;">12</div><div class="p-sub">Closed lost</div></div>
            <div class="p-cell c-amber"><div class="p-label">On Hold</div><div class="p-num" style="color:#d97706;">4</div><div class="p-sub">Client paused</div></div>
            <div class="p-cell c-gray"><div class="p-label">N / A</div><div class="p-num">6</div><div class="p-sub">Not applicable</div></div>
          </div>
        </div>
      </div>
      <div class="card">
        <div class="card-head"><div class="card-title">Active Jobs</div><span class="chip chip-muted">Sorted by priority</span></div>
        <table class="tbl">
          <thead><tr><th>Job</th><th>Profile</th><th>Agent</th><th>Stage</th><th>Time in Stage</th><th>Priority</th></tr></thead>
          <tbody>
            <tr><td style="font-weight:600;">CRM Integration – Pipedrive</td><td>Profile #3</td><td>Ahmed K.</td><td><span class="chip chip-green">Negotiation</span></td><td style="color:#059669;font-family:'DM Mono',monospace;font-size:12px;">1d 2h</td><td><span class="chip chip-red">High</span></td></tr>
            <tr><td style="font-weight:600;">AI Chatbot for eCommerce</td><td>Profile #7</td><td>Ahmed K.</td><td><span class="chip chip-green">Negotiation</span></td><td style="color:#059669;font-family:'DM Mono',monospace;font-size:12px;">3h</td><td><span class="chip chip-red">High</span></td></tr>
            <tr><td style="font-weight:600;">Mobile App UI Redesign</td><td>Profile #1</td><td>Sara R.</td><td><span class="chip chip-amber">Mtg Scheduled</span></td><td style="font-family:'DM Mono',monospace;font-size:12px;">tomorrow</td><td><span class="chip chip-amber">Medium</span></td></tr>
            <tr><td style="font-weight:600;">n8n Automation Build</td><td>Profile #5</td><td>Mike J.</td><td><span class="chip chip-amber">Proto Required</span></td><td style="color:#d97706;font-family:'DM Mono',monospace;font-size:12px;">2d 5h</td><td><span class="chip chip-amber">Medium</span></td></tr>
            <tr><td style="font-weight:600;">SaaS Landing Page Copy</td><td>Profile #9</td><td>Sara R.</td><td><span class="chip chip-blue">Submitted</span></td><td style="font-family:'DM Mono',monospace;font-size:12px;">4h</td><td><span class="chip chip-muted">Low</span></td></tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- AGENTS -->
    <div class="panel" id="panel-agents">
      <div class="kpi-row">
        <div class="kpi-card"><div class="kpi-label">Avg Time to Apply</div><div class="kpi-value blue" id="atab-avgtime">47m</div><div class="kpi-footer"><span class="kpi-up">↓ −12m</span> vs target</div></div>
        <div class="kpi-card"><div class="kpi-label">Total Proposals</div><div class="kpi-value" id="atab-proposals">91</div><div class="kpi-footer">This week</div></div>
        <div class="kpi-card"><div class="kpi-label">Meetings Booked</div><div class="kpi-value amber" id="atab-meetings">18</div><div class="kpi-footer">19.8% booking rate</div></div>
        <div class="kpi-card"><div class="kpi-label">Total Wins</div><div class="kpi-value green" id="atab-wins">6</div><div class="kpi-footer">33% close rate</div></div>
        <div class="kpi-card"><div class="kpi-label">Negotiation Rate</div><div class="kpi-value" id="atab-negrate">60%</div><div class="kpi-footer">Meetings → negotiation</div></div>
      </div>
      <div class="g3" id="agent-cards-container">
        <div class="agent-card">
          <div class="agent-header"><div class="avatar av-blue">AK</div><div style="flex:1;"><div class="agent-name">Ahmed K.</div><div class="agent-role">SaaS · AI/ML profiles</div></div><span class="chip chip-green">Top Agent</span></div>
          <div class="agent-body">
            <div class="agent-kpi-row">
              <div class="agent-kpi"><div class="agent-kpi-val" style="color:var(--accent);">31</div><div class="agent-kpi-lbl">Applied</div></div>
              <div class="agent-kpi"><div class="agent-kpi-val" style="color:#d97706;">8</div><div class="agent-kpi-lbl">Meetings</div></div>
              <div class="agent-kpi"><div class="agent-kpi-val" style="color:#059669;">3</div><div class="agent-kpi-lbl">Won</div></div>
            </div>
            <div class="metric-row"><span class="metric-key">Avg time to apply</span><span class="metric-val good">38 min</span></div>
            <div class="metric-row"><span class="metric-key">Conversion rate</span><span class="metric-val good">9.7%</span></div>
            <div class="metric-row"><span class="metric-key">Negotiation rate</span><span class="metric-val">75%</span></div>
            <div class="metric-row"><span class="metric-key">Bonus earned</span><span class="metric-val good">$180</span></div>
          </div>
        </div>
        <div class="agent-card">
          <div class="agent-header"><div class="avatar av-green">SR</div><div style="flex:1;"><div class="agent-name">Sara R.</div><div class="agent-role">Design · Copywriting profiles</div></div><span class="chip chip-blue">Steady</span></div>
          <div class="agent-body">
            <div class="agent-kpi-row">
              <div class="agent-kpi"><div class="agent-kpi-val" style="color:var(--accent);">28</div><div class="agent-kpi-lbl">Applied</div></div>
              <div class="agent-kpi"><div class="agent-kpi-val" style="color:#d97706;">6</div><div class="agent-kpi-lbl">Meetings</div></div>
              <div class="agent-kpi"><div class="agent-kpi-val" style="color:#059669;">2</div><div class="agent-kpi-lbl">Won</div></div>
            </div>
            <div class="metric-row"><span class="metric-key">Avg time to apply</span><span class="metric-val warn">52 min</span></div>
            <div class="metric-row"><span class="metric-key">Conversion rate</span><span class="metric-val warn">7.1%</span></div>
            <div class="metric-row"><span class="metric-key">Negotiation rate</span><span class="metric-val">60%</span></div>
            <div class="metric-row"><span class="metric-key">Bonus earned</span><span class="metric-val">$120</span></div>
          </div>
        </div>
        <div class="agent-card">
          <div class="agent-header"><div class="avatar av-amber">MJ</div><div style="flex:1;"><div class="agent-name">Mike J.</div><div class="agent-role">Automation profiles</div></div><span class="chip chip-amber">Needs Review</span></div>
          <div class="agent-body">
            <div class="agent-kpi-row">
              <div class="agent-kpi"><div class="agent-kpi-val" style="color:var(--accent);">19</div><div class="agent-kpi-lbl">Applied</div></div>
              <div class="agent-kpi"><div class="agent-kpi-val" style="color:#d97706;">4</div><div class="agent-kpi-lbl">Meetings</div></div>
              <div class="agent-kpi"><div class="agent-kpi-val" style="color:#dc2626;">1</div><div class="agent-kpi-lbl">Won</div></div>
            </div>
            <div class="metric-row"><span class="metric-key">Avg time to apply</span><span class="metric-val bad">1h 24m</span></div>
            <div class="metric-row"><span class="metric-key">Conversion rate</span><span class="metric-val bad">5.3%</span></div>
            <div class="metric-row"><span class="metric-key">Negotiation rate</span><span class="metric-val warn">40%</span></div>
            <div class="metric-row"><span class="metric-key">Bonus earned</span><span class="metric-val warn">$60</span></div>
          </div>
        </div>
      </div>
    </div>

    <!-- PROFILES -->
    <div class="panel" id="panel-profiles">
      <div class="kpi-row">
        <div class="kpi-card"><div class="kpi-label">Active Profiles</div><div class="kpi-value blue">10</div><div class="kpi-footer">All operational</div></div>
        <div class="kpi-card"><div class="kpi-label">Avg Response Rate</div><div class="kpi-value">44%</div><div class="kpi-footer"><span class="kpi-up">↑ 4%</span> this month</div></div>
        <div class="kpi-card"><div class="kpi-label">Avg Interview Rate</div><div class="kpi-value amber">22%</div><div class="kpi-footer">Industry avg: 18%</div></div>
        <div class="kpi-card"><div class="kpi-label">Best Niche</div><div class="kpi-value green" style="font-size:18px;margin-top:4px;">SaaS Dev</div><div class="kpi-footer">42% interview rate</div></div>
        <div class="kpi-card"><div class="kpi-label">Weakest Profile</div><div class="kpi-value red" style="font-size:18px;margin-top:4px;">Profile #6</div><div class="kpi-footer">8% response rate</div></div>
      </div>
      <div class="card">
        <div class="card-head"><div class="card-title">All Profiles — Performance Ranking</div><span class="chip chip-muted">This Month</span></div>
        <div style="padding:16px;">
          <div class="profile-grid">
            <div class="pf-card"><div class="pf-rank">#1 · Best</div><div class="pf-name">Profile #3</div><div class="pf-niche">SaaS Dev</div><div class="pf-stat-row"><span class="pf-stat-key">Response</span><span class="pf-stat-val" style="color:#059669;">52%</span></div><div class="pf-stat-row"><span class="pf-stat-key">Interview</span><span class="pf-stat-val" style="color:#059669;">42%</span></div><div class="pf-stat-row"><span class="pf-stat-key">Win Rate</span><span class="pf-stat-val" style="color:#059669;">21%</span></div><div class="progress-bar"><div class="progress-fill" style="width:52%;background:#059669;"></div></div></div>
            <div class="pf-card"><div class="pf-rank">#2</div><div class="pf-name">Profile #7</div><div class="pf-niche">AI / ML</div><div class="pf-stat-row"><span class="pf-stat-key">Response</span><span class="pf-stat-val" style="color:#059669;">48%</span></div><div class="pf-stat-row"><span class="pf-stat-key">Interview</span><span class="pf-stat-val" style="color:#059669;">36%</span></div><div class="pf-stat-row"><span class="pf-stat-key">Win Rate</span><span class="pf-stat-val" style="color:#059669;">18%</span></div><div class="progress-bar"><div class="progress-fill" style="width:48%;background:#059669;"></div></div></div>
            <div class="pf-card"><div class="pf-rank">#3</div><div class="pf-name">Profile #1</div><div class="pf-niche">UI Design</div><div class="pf-stat-row"><span class="pf-stat-key">Response</span><span class="pf-stat-val">38%</span></div><div class="pf-stat-row"><span class="pf-stat-key">Interview</span><span class="pf-stat-val">22%</span></div><div class="pf-stat-row"><span class="pf-stat-key">Win Rate</span><span class="pf-stat-val">11%</span></div><div class="progress-bar"><div class="progress-fill" style="width:38%;background:#d97706;"></div></div></div>
            <div class="pf-card"><div class="pf-rank">#4</div><div class="pf-name">Profile #2</div><div class="pf-niche">Automation</div><div class="pf-stat-row"><span class="pf-stat-key">Response</span><span class="pf-stat-val">35%</span></div><div class="pf-stat-row"><span class="pf-stat-key">Interview</span><span class="pf-stat-val">20%</span></div><div class="pf-stat-row"><span class="pf-stat-key">Win Rate</span><span class="pf-stat-val">9%</span></div><div class="progress-bar"><div class="progress-fill" style="width:35%;background:#d97706;"></div></div></div>
            <div class="pf-card"><div class="pf-rank">#5</div><div class="pf-name">Profile #4</div><div class="pf-niche">Backend Dev</div><div class="pf-stat-row"><span class="pf-stat-key">Response</span><span class="pf-stat-val">32%</span></div><div class="pf-stat-row"><span class="pf-stat-key">Interview</span><span class="pf-stat-val">18%</span></div><div class="pf-stat-row"><span class="pf-stat-key">Win Rate</span><span class="pf-stat-val">8%</span></div><div class="progress-bar"><div class="progress-fill" style="width:32%;background:#d97706;"></div></div></div>
            <div class="pf-card"><div class="pf-rank">#6</div><div class="pf-name">Profile #5</div><div class="pf-niche">Full Stack</div><div class="pf-stat-row"><span class="pf-stat-key">Response</span><span class="pf-stat-val">28%</span></div><div class="pf-stat-row"><span class="pf-stat-key">Interview</span><span class="pf-stat-val">15%</span></div><div class="pf-stat-row"><span class="pf-stat-key">Win Rate</span><span class="pf-stat-val">6%</span></div><div class="progress-bar"><div class="progress-fill" style="width:28%;background:#ea580c;"></div></div></div>
            <div class="pf-card"><div class="pf-rank">#7</div><div class="pf-name">Profile #8</div><div class="pf-niche">Copywriting</div><div class="pf-stat-row"><span class="pf-stat-key">Response</span><span class="pf-stat-val">26%</span></div><div class="pf-stat-row"><span class="pf-stat-key">Interview</span><span class="pf-stat-val">14%</span></div><div class="pf-stat-row"><span class="pf-stat-key">Win Rate</span><span class="pf-stat-val">5%</span></div><div class="progress-bar"><div class="progress-fill" style="width:26%;background:#ea580c;"></div></div></div>
            <div class="pf-card"><div class="pf-rank">#8</div><div class="pf-name">Profile #10</div><div class="pf-niche">SEO / Content</div><div class="pf-stat-row"><span class="pf-stat-key">Response</span><span class="pf-stat-val">20%</span></div><div class="pf-stat-row"><span class="pf-stat-key">Interview</span><span class="pf-stat-val">11%</span></div><div class="pf-stat-row"><span class="pf-stat-key">Win Rate</span><span class="pf-stat-val">4%</span></div><div class="progress-bar"><div class="progress-fill" style="width:20%;background:#dc2626;"></div></div></div>
            <div class="pf-card"><div class="pf-rank">#9</div><div class="pf-name">Profile #9</div><div class="pf-niche">No-Code</div><div class="pf-stat-row"><span class="pf-stat-key">Response</span><span class="pf-stat-val" style="color:#dc2626;">14%</span></div><div class="pf-stat-row"><span class="pf-stat-key">Interview</span><span class="pf-stat-val" style="color:#dc2626;">9%</span></div><div class="pf-stat-row"><span class="pf-stat-key">Win Rate</span><span class="pf-stat-val" style="color:#dc2626;">3%</span></div><div class="progress-bar"><div class="progress-fill" style="width:14%;background:#dc2626;"></div></div></div>
            <div class="pf-card" style="border-color:var(--red-mid);"><div class="pf-rank" style="color:#dc2626;">#10 · Weakest</div><div class="pf-name">Profile #6</div><div class="pf-niche">E-Commerce</div><div class="pf-stat-row"><span class="pf-stat-key">Response</span><span class="pf-stat-val" style="color:#dc2626;">8%</span></div><div class="pf-stat-row"><span class="pf-stat-key">Interview</span><span class="pf-stat-val" style="color:#dc2626;">5%</span></div><div class="pf-stat-row"><span class="pf-stat-key">Win Rate</span><span class="pf-stat-val" style="color:#dc2626;">1%</span></div><div class="progress-bar"><div class="progress-fill" style="width:8%;background:#dc2626;"></div></div></div>
          </div>
        </div>
      </div>
    </div>

    <!-- CONNECTS -->
    <div class="panel" id="panel-connects">
      <div class="kpi-row">
        <div class="kpi-card"><div class="kpi-label">Total Used</div><div class="kpi-value amber">842</div><div class="kpi-footer">This week</div></div>
        <div class="kpi-card"><div class="kpi-label">Cost Per Win</div><div class="kpi-value">140</div><div class="kpi-footer"><span class="kpi-up">↓ −18</span> improving</div></div>
        <div class="kpi-card"><div class="kpi-label">Wasted Connects</div><div class="kpi-value red">318</div><div class="kpi-footer">Low-quality jobs</div></div>
        <div class="kpi-card"><div class="kpi-label">Most Efficient</div><div class="kpi-value green" style="font-size:18px;margin-top:4px;">Profile #3</div><div class="kpi-footer">84 connects / win</div></div>
        <div class="kpi-card"><div class="kpi-label">Least Efficient</div><div class="kpi-value red" style="font-size:18px;margin-top:4px;">Profile #6</div><div class="kpi-footer">0 wins · 96 used</div></div>
      </div>
      <div class="g2">
        <div class="card">
          <div class="card-head"><div class="card-title">Usage by Profile</div><span class="chip chip-amber">Budget Watch</span></div>
          <div style="padding:16px;display:flex;flex-direction:column;gap:16px;">
            <div><div style="display:flex;justify-content:space-between;font-size:12px;margin-bottom:6px;"><span style="font-weight:600;">Profile #3 · SaaS Dev</span><span style="font-family:'DM Mono',monospace;font-size:11.5px;color:#059669;">84 / 150</span></div><div style="height:8px;background:var(--bg);border-radius:4px;overflow:hidden;"><div style="width:56%;height:100%;background:#059669;border-radius:4px;"></div></div></div>
            <div><div style="display:flex;justify-content:space-between;font-size:12px;margin-bottom:6px;"><span style="font-weight:600;">Profile #7 · AI/ML</span><span style="font-family:'DM Mono',monospace;font-size:11.5px;color:#059669;">93 / 150</span></div><div style="height:8px;background:var(--bg);border-radius:4px;overflow:hidden;"><div style="width:62%;height:100%;background:#059669;border-radius:4px;"></div></div></div>
            <div><div style="display:flex;justify-content:space-between;font-size:12px;margin-bottom:6px;"><span style="font-weight:600;">Profile #1 · UI Design</span><span style="font-family:'DM Mono',monospace;font-size:11.5px;color:#d97706;">108 / 150</span></div><div style="height:8px;background:var(--bg);border-radius:4px;overflow:hidden;"><div style="width:72%;height:100%;background:#d97706;border-radius:4px;"></div></div></div>
            <div><div style="display:flex;justify-content:space-between;font-size:12px;margin-bottom:6px;"><span style="font-weight:600;">Profile #9 · No-Code</span><span style="font-family:'DM Mono',monospace;font-size:11.5px;color:#dc2626;">117 / 150</span></div><div style="height:8px;background:var(--bg);border-radius:4px;overflow:hidden;"><div style="width:78%;height:100%;background:#dc2626;border-radius:4px;"></div></div></div>
            <div><div style="display:flex;justify-content:space-between;font-size:12px;margin-bottom:6px;"><span style="font-weight:600;">Profile #6 · E-Commerce</span><span style="font-family:'DM Mono',monospace;font-size:11.5px;color:#dc2626;">96 / 150</span></div><div style="height:8px;background:var(--bg);border-radius:4px;overflow:hidden;"><div style="width:64%;height:100%;background:#dc2626;border-radius:4px;"></div></div></div>
          </div>
        </div>
        <div class="card">
          <div class="card-head"><div class="card-title">ROI by Niche</div><span class="chip chip-green">Optimization</span></div>
          <table class="tbl">
            <thead><tr><th>Niche</th><th>Connects</th><th>Wins</th><th>Cost/Win</th><th>Signal</th></tr></thead>
            <tbody>
              <tr><td style="font-weight:600;">SaaS Dev</td><td style="font-family:'DM Mono',monospace;">252</td><td style="color:#059669;font-weight:700;font-family:'DM Mono',monospace;">3</td><td style="color:#059669;font-weight:700;font-family:'DM Mono',monospace;">84</td><td><span class="chip chip-green">Scale Up</span></td></tr>
              <tr><td style="font-weight:600;">AI / ML</td><td style="font-family:'DM Mono',monospace;">186</td><td style="color:#059669;font-weight:700;font-family:'DM Mono',monospace;">2</td><td style="color:#059669;font-weight:700;font-family:'DM Mono',monospace;">93</td><td><span class="chip chip-green">Scale Up</span></td></tr>
              <tr><td style="font-weight:600;">UI Design</td><td style="font-family:'DM Mono',monospace;">108</td><td style="font-family:'DM Mono',monospace;">1</td><td style="color:#d97706;font-weight:700;font-family:'DM Mono',monospace;">108</td><td><span class="chip chip-amber">Optimize</span></td></tr>
              <tr><td style="font-weight:600;">No-Code</td><td style="font-family:'DM Mono',monospace;">117</td><td style="color:#dc2626;font-family:'DM Mono',monospace;">0</td><td style="color:#dc2626;font-weight:700;font-family:'DM Mono',monospace;">∞</td><td><span class="chip chip-red">Pause</span></td></tr>
              <tr><td style="font-weight:600;">E-Commerce</td><td style="font-family:'DM Mono',monospace;">96</td><td style="color:#dc2626;font-family:'DM Mono',monospace;">0</td><td style="color:#dc2626;font-weight:700;font-family:'DM Mono',monospace;">∞</td><td><span class="chip chip-red">Review</span></td></tr>
            </tbody>
          </table>
          <div style="margin:0 16px 16px;padding:12px 14px;background:var(--accent-light);border:1px solid var(--accent-mid);border-radius:8px;">
            <div style="font-size:12px;font-weight:700;color:var(--accent);margin-bottom:3px;">Recommendation</div>
            <div style="font-size:12px;color:var(--text-secondary);line-height:1.5;">Raising minimum budget filter to $800 would eliminate 38% of wasted connects with minimal impact on job volume.</div>
          </div>
        </div>
      </div>
    </div>

    <!-- ALERTS -->
    <div class="panel" id="panel-alerts">
      <div class="kpi-row">
        <div class="kpi-card"><div class="kpi-label">Critical Alerts</div><div class="kpi-value red">3</div><div class="kpi-footer">Require action</div></div>
        <div class="kpi-card"><div class="kpi-label">Warnings</div><div class="kpi-value amber">5</div><div class="kpi-footer">Monitor closely</div></div>
        <div class="kpi-card"><div class="kpi-label">Opportunities</div><div class="kpi-value green">2</div><div class="kpi-footer">Act now</div></div>
        <div class="kpi-card"><div class="kpi-label">Overdue Items</div><div class="kpi-value red">4</div><div class="kpi-footer">Past SLA</div></div>
        <div class="kpi-card"><div class="kpi-label">System Health</div><div class="kpi-value green" style="font-size:18px;margin-top:4px;">Good</div><div class="kpi-footer">n8n + Vollna online</div></div>
      </div>
      <div class="g2">
        <div>
          <div style="font-size:13px;font-weight:700;color:var(--text-primary);margin-bottom:12px;">Critical Alerts</div>
          <div class="alert-item alert-critical"><div class="alert-icon ai-red">🚨</div><div><div class="alert-title">Profile #6 — Zero wins in 3 weeks</div><div class="alert-body">E-commerce niche showing 8% response rate and 0 wins. 96 connects spent. Recommend pausing or restructuring filter logic immediately.</div></div></div>
          <div class="alert-item alert-critical"><div class="alert-icon ai-red">⏱</div><div><div class="alert-title">Mike J. — Response time above threshold</div><div class="alert-body">Average time-to-apply is 1h 24m. Jobs submitted after 1 hour have a 40% lower win probability. Coaching intervention recommended.</div></div></div>
          <div class="alert-item alert-critical"><div class="alert-icon ai-red">📋</div><div><div class="alert-title">4 jobs stalled in "To Do" for 48h+</div><div class="alert-body">CRM Integration (Profile #2), 2× automation jobs, and 1 design job are overdue. Reassign or escalate immediately.</div></div></div>
        </div>
        <div>
          <div style="font-size:13px;font-weight:700;color:var(--text-primary);margin-bottom:12px;">Warnings & Opportunities</div>
          <div class="alert-item alert-warning"><div class="alert-icon ai-amber">⚡</div><div><div class="alert-title">Profile #9 — Low connect efficiency</div><div class="alert-body">117 connects used, no wins, 3% win rate. No-code filter may be too broad — tighten budget and hire-rate thresholds.</div></div></div>
          <div class="alert-item alert-warning"><div class="alert-icon ai-amber">📅</div><div><div class="alert-title">3 completed meetings need follow-up</div><div class="alert-body">Jobs remain in "Meeting Done" without progressing. Follow up within 24h to maintain pipeline hygiene.</div></div></div>
          <div class="alert-item alert-success"><div class="alert-icon ai-green">📈</div><div><div class="alert-title">SaaS + AI/ML niches outperforming</div><div class="alert-body">Both niches show 36–42% interview rates. Increasing connects to Profiles #3 and #7 could yield 2–3 extra wins per week.</div></div></div>
          <div class="alert-item alert-info"><div class="alert-icon ai-blue">💡</div><div><div class="alert-title">Filter recommendation — raise minimum budget</div><div class="alert-body">Raising budget floor to $800 eliminates 38% of wasted connects. Estimated savings: ~90 connects/week.</div></div></div>
        </div>
      </div>
    </div>

    <!-- LIVE JOB FEED -->
    <div class="panel" id="panel-livefeed">
      <div class="kpi-row">
        <div class="kpi-card"><div class="kpi-label">Jobs Today</div><div class="kpi-value blue" id="feed-count-today">0</div><div class="kpi-footer">Since midnight</div></div>
        <div class="kpi-card"><div class="kpi-label">Accepted</div><div class="kpi-value green" id="feed-count-accepted">0</div><div class="kpi-footer">Sent to drafting</div></div>
        <div class="kpi-card"><div class="kpi-label">Rejected</div><div class="kpi-value red" id="feed-count-rejected">0</div><div class="kpi-footer">Filtered out</div></div>
        <div class="kpi-card"><div class="kpi-label">Pending Review</div><div class="kpi-value amber" id="feed-count-pending">0</div><div class="kpi-footer">Needs decision</div></div>
        <div class="kpi-card"><div class="kpi-label">Avg. Score</div><div class="kpi-value" id="feed-avg-score">—</div><div class="kpi-footer">Job quality score</div></div>
      </div>
      <div class="feed-layout">
        <div>
          <div class="card" style="margin-bottom:16px;">
            <div class="card-head">
              <div><div class="card-title">Incoming Jobs</div><div class="card-sub">Live from Upwork via Vollna · auto-refreshing</div></div>
              <div class="feed-controls">
                <div style="display:flex;align-items:center;gap:6px;font-size:12px;color:var(--text-muted);"><div class="status-dot"></div> Live</div>
                <button class="feed-pause-btn" id="feedPauseBtn" onclick="toggleFeedPause()">⏸ Pause</button>
                <button class="feed-pause-btn" onclick="clearFeed()">Clear</button>
              </div>
            </div>
          </div>
          <div id="feedList" class="feed-list"></div>
          <div id="feedEmpty" style="display:none;text-align:center;padding:60px 20px;color:var(--text-muted);">
            <div style="font-size:32px;margin-bottom:12px;">📡</div>
            <div style="font-size:14px;font-weight:600;color:var(--text-secondary);margin-bottom:6px;">Listening for new jobs…</div>
            <div style="font-size:12px;">Jobs will appear here as they are posted on Upwork</div>
          </div>
        </div>
        <div class="feed-sidebar">
          <div class="feed-stat-mini">
            <div class="feed-stat-mini-label">Jobs / Hour Rate</div>
            <div class="feed-stat-mini-val" id="feedRateVal">—</div>
            <div class="feed-stat-mini-sub">Based on last 10 min</div>
          </div>
          <div class="feed-ticker">
            <div class="feed-ticker-head">
              <div class="feed-ticker-title">Activity Log</div>
              <span class="chip chip-green" style="font-size:10px;">Live</span>
            </div>
            <div class="feed-ticker-body" id="feedTicker"></div>
          </div>
          <div class="feed-profile-match">
            <div class="feed-pm-title">Profile Match Rate</div>
            <div id="feedProfileMatches">
              <div class="feed-pm-row"><div class="feed-pm-name">Profile #3 · SaaS</div><div class="feed-pm-bar-wrap"><div class="feed-pm-bar" style="width:82%;"></div></div><div class="feed-pm-pct">82%</div></div>
              <div class="feed-pm-row"><div class="feed-pm-name">Profile #7 · AI/ML</div><div class="feed-pm-bar-wrap"><div class="feed-pm-bar" style="width:74%;"></div></div><div class="feed-pm-pct">74%</div></div>
              <div class="feed-pm-row"><div class="feed-pm-name">Profile #1 · Design</div><div class="feed-pm-bar-wrap"><div class="feed-pm-bar" style="width:61%;background:#d97706;"></div></div><div class="feed-pm-pct">61%</div></div>
              <div class="feed-pm-row"><div class="feed-pm-name">Profile #5 · Full Stack</div><div class="feed-pm-bar-wrap"><div class="feed-pm-bar" style="width:55%;background:#d97706;"></div></div><div class="feed-pm-pct">55%</div></div>
              <div class="feed-pm-row"><div class="feed-pm-name">Profile #9 · No-Code</div><div class="feed-pm-bar-wrap"><div class="feed-pm-bar" style="width:28%;background:#dc2626;"></div></div><div class="feed-pm-pct">28%</div></div>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>
</div>

<script>
function setTab(id, title, el) {
  document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  document.getElementById('panel-' + id).classList.add('active');
  document.getElementById('page-title').textContent = title;
  el.classList.add('active');
}
document.querySelectorAll('.btn-ghost').forEach(btn => {
  btn.addEventListener('click', function() {
    if (this.textContent.trim() === 'Export') return;
    document.querySelectorAll('.btn-ghost').forEach(b => b.classList.remove('active'));
    this.classList.add('active');
  });
});




// ══════════════════════════════════════════════
//   DASHBOARD FILTER ENGINE
// ══════════════════════════════════════════════

// ── Master data store ──
const DASHBOARD_DATA = {
  all: {
    jobsReceived: 248, proposalsSent: 91, meetingsBooked: 18, jobsWon: 6, closeRate: 33,
    jobsReceivedDelta: '+34', proposalsPassRate: '36.7%', meetingsRate: '19.8%', jobsWonDelta: '+2',
    // Pipeline
    toDo: 23, submitted: 41, protoStage: 8, meetingStage: 9, negotiation: 3,
    // Agent leaderboard
    agents: [
      { rank:1, init:'AK', cls:'av-blue', name:'Ahmed K.', role:'SaaS + AI profiles', applied:31, meetings:8, won:3 },
      { rank:2, init:'SR', cls:'av-green', name:'Sara R.', role:'Design + Copy profiles', applied:28, meetings:6, won:2 },
      { rank:3, init:'MJ', cls:'av-amber', name:'Mike J.', role:'Automation profiles', applied:19, meetings:4, won:1 },
    ],
    // Top profiles
    profiles: [
      { name:'Profile #3', niche:'SaaS Dev', chipCls:'chip-blue', proposals:14, interviewRate:'42%', interviewColor:'#059669', won:3, wonColor:'#059669' },
      { name:'Profile #7', niche:'AI / ML',  chipCls:'chip-purple', proposals:11, interviewRate:'36%', interviewColor:'#059669', won:2, wonColor:'#059669' },
      { name:'Profile #1', niche:'Design',   chipCls:'chip-amber', proposals:18, interviewRate:'22%', interviewColor:'#d97706', won:1, wonColor:'' },
      { name:'Profile #9', niche:'No-Code',  chipCls:'chip-muted', proposals:9,  interviewRate:'8%',  interviewColor:'#dc2626', won:0, wonColor:'#dc2626' },
    ],
    // Funnel
    funnel: [248, 169, 91, 40, 20, 12, 6],
    // Pipeline mini
    pipelineLive: { toDo:23, inProgress:14, meetings:5, negotiation:3 },
    // Agents tab
    agentCards: {
      ahmed: { applied:31, meetings:8, won:3, timeToApply:'38 min', timeColor:'good', convRate:'9.7%', convColor:'good', negRate:'75%', negColor:'', bonus:'$180', bonusColor:'good' },
      sara:  { applied:28, meetings:6, won:2, timeToApply:'52 min', timeColor:'warn', convRate:'7.1%', convColor:'warn', negRate:'60%', negColor:'', bonus:'$120', bonusColor:'' },
      mike:  { applied:19, meetings:4, won:1, timeToApply:'1h 24m', timeColor:'bad',  convRate:'5.3%', convColor:'bad',  negRate:'40%', negColor:'warn', bonus:'$60',  bonusColor:'warn' },
    },
    agentTabKpis: { avgTime:'47m', proposals:91, meetingsBooked:18, wins:6, negRate:'60%' }
  },
  ahmed: {
    jobsReceived: 89, proposalsSent: 31, meetingsBooked: 8, jobsWon: 3, closeRate: 38,
    jobsReceivedDelta: '+12', proposalsPassRate: '34.8%', meetingsRate: '25.8%', jobsWonDelta: '+1',
    toDo: 9, submitted: 14, protoStage: 2, meetingStage: 4, negotiation: 2,
    agents: [{ rank:1, init:'AK', cls:'av-blue', name:'Ahmed K.', role:'SaaS + AI profiles', applied:31, meetings:8, won:3 }],
    profiles: [
      { name:'Profile #3', niche:'SaaS Dev', chipCls:'chip-blue', proposals:14, interviewRate:'42%', interviewColor:'#059669', won:3, wonColor:'#059669' },
      { name:'Profile #7', niche:'AI / ML',  chipCls:'chip-purple', proposals:11, interviewRate:'36%', interviewColor:'#059669', won:2, wonColor:'#059669' },
      { name:'Profile #5', niche:'Full Stack',chipCls:'chip-muted', proposals:6,  interviewRate:'18%', interviewColor:'#d97706', won:0, wonColor:'' },
    ],
    funnel: [89, 62, 31, 14, 9, 6, 3],
    pipelineLive: { toDo:9, inProgress:7, meetings:3, negotiation:2 },
    agentCards: { ahmed: { applied:31, meetings:8, won:3, timeToApply:'38 min', timeColor:'good', convRate:'9.7%', convColor:'good', negRate:'75%', negColor:'', bonus:'$180', bonusColor:'good' } },
    agentTabKpis: { avgTime:'38m', proposals:31, meetingsBooked:8, wins:3, negRate:'75%' }
  },
  sara: {
    jobsReceived: 96, proposalsSent: 28, meetingsBooked: 6, jobsWon: 2, closeRate: 33,
    jobsReceivedDelta: '+14', proposalsPassRate: '29.2%', meetingsRate: '21.4%', jobsWonDelta: '+1',
    toDo: 8, submitted: 15, protoStage: 3, meetingStage: 3, negotiation: 1,
    agents: [{ rank:1, init:'SR', cls:'av-green', name:'Sara R.', role:'Design + Copy profiles', applied:28, meetings:6, won:2 }],
    profiles: [
      { name:'Profile #1', niche:'Design',     chipCls:'chip-amber', proposals:18, interviewRate:'22%', interviewColor:'#d97706', won:1, wonColor:'' },
      { name:'Profile #8', niche:'Copywriting', chipCls:'chip-muted', proposals:10, interviewRate:'14%', interviewColor:'#d97706', won:1, wonColor:'' },
    ],
    funnel: [96, 68, 28, 11, 7, 3, 2],
    pipelineLive: { toDo:8, inProgress:5, meetings:2, negotiation:1 },
    agentCards: { sara: { applied:28, meetings:6, won:2, timeToApply:'52 min', timeColor:'warn', convRate:'7.1%', convColor:'warn', negRate:'60%', negColor:'', bonus:'$120', bonusColor:'' } },
    agentTabKpis: { avgTime:'52m', proposals:28, meetingsBooked:6, wins:2, negRate:'60%' }
  },
  mike: {
    jobsReceived: 63, proposalsSent: 19, meetingsBooked: 4, jobsWon: 1, closeRate: 25,
    jobsReceivedDelta: '+8', proposalsPassRate: '30.2%', meetingsRate: '21.1%', jobsWonDelta: '0',
    toDo: 6, submitted: 9, protoStage: 3, meetingStage: 2, negotiation: 0,
    agents: [{ rank:1, init:'MJ', cls:'av-amber', name:'Mike J.', role:'Automation profiles', applied:19, meetings:4, won:1 }],
    profiles: [
      { name:'Profile #2', niche:'Automation', chipCls:'chip-muted', proposals:9, interviewRate:'20%', interviewColor:'#d97706', won:1, wonColor:'' },
      { name:'Profile #5', niche:'Full Stack',  chipCls:'chip-muted', proposals:10, interviewRate:'15%', interviewColor:'#dc2626', won:0, wonColor:'#dc2626' },
    ],
    funnel: [63, 44, 19, 7, 4, 1, 1],
    pipelineLive: { toDo:6, inProgress:4, meetings:1, negotiation:0 },
    agentCards: { mike: { applied:19, meetings:4, won:1, timeToApply:'1h 24m', timeColor:'bad', convRate:'5.3%', convColor:'bad', negRate:'40%', negColor:'warn', bonus:'$60', bonusColor:'warn' } },
    agentTabKpis: { avgTime:'1h 24m', proposals:19, meetingsBooked:4, wins:1, negRate:'40%' }
  },
  // Profile-specific datasets
  p1: { jobsReceived:44, proposalsSent:18, meetingsBooked:4, jobsWon:1, closeRate:25, jobsReceivedDelta:'+6', proposalsPassRate:'40.9%', meetingsRate:'22.2%', jobsWonDelta:'0', toDo:3, submitted:8, protoStage:2, meetingStage:2, negotiation:0, funnel:[44,30,18,7,4,1,1], pipelineLive:{toDo:3,inProgress:5,meetings:2,negotiation:0}, agents:[], profiles:[{name:'Profile #1',niche:'Design',chipCls:'chip-amber',proposals:18,interviewRate:'22%',interviewColor:'#d97706',won:1,wonColor:''}], agentCards:{}, agentTabKpis:{avgTime:'52m',proposals:18,meetingsBooked:4,wins:1,negRate:'50%'} },
  p3: { jobsReceived:52, proposalsSent:14, meetingsBooked:6, jobsWon:3, closeRate:50, jobsReceivedDelta:'+9', proposalsPassRate:'26.9%', meetingsRate:'42.9%', jobsWonDelta:'+2', toDo:4, submitted:5, protoStage:1, meetingStage:3, negotiation:2, funnel:[52,38,14,8,6,4,3], pipelineLive:{toDo:4,inProgress:4,meetings:3,negotiation:2}, agents:[], profiles:[{name:'Profile #3',niche:'SaaS Dev',chipCls:'chip-blue',proposals:14,interviewRate:'42%',interviewColor:'#059669',won:3,wonColor:'#059669'}], agentCards:{}, agentTabKpis:{avgTime:'38m',proposals:14,meetingsBooked:6,wins:3,negRate:'83%'} },
  p7: { jobsReceived:41, proposalsSent:11, meetingsBooked:5, jobsWon:2, closeRate:40, jobsReceivedDelta:'+7', proposalsPassRate:'26.8%', meetingsRate:'45.5%', jobsWonDelta:'+1', toDo:3, submitted:5, protoStage:1, meetingStage:2, negotiation:1, funnel:[41,30,11,7,5,3,2], pipelineLive:{toDo:3,inProgress:3,meetings:2,negotiation:1}, agents:[], profiles:[{name:'Profile #7',niche:'AI / ML',chipCls:'chip-purple',proposals:11,interviewRate:'36%',interviewColor:'#059669',won:2,wonColor:'#059669'}], agentCards:{}, agentTabKpis:{avgTime:'41m',proposals:11,meetingsBooked:5,wins:2,negRate:'80%'} },
};

// Fallback for profiles without dedicated data
const PROFILE_DEFAULTS = {
  p2:{name:'Profile #2',niche:'Automation',jobsReceived:38,proposalsSent:12,meetingsBooked:2,jobsWon:1,closeRate:50,funnel:[38,24,12,5,2,1,1]},
  p4:{name:'Profile #4',niche:'Backend Dev',jobsReceived:35,proposalsSent:10,meetingsBooked:2,jobsWon:1,closeRate:50,funnel:[35,22,10,4,2,1,1]},
  p5:{name:'Profile #5',niche:'Full Stack',jobsReceived:42,proposalsSent:13,meetingsBooked:2,jobsWon:0,closeRate:0,funnel:[42,26,13,4,2,0,0]},
  p6:{name:'Profile #6',niche:'E-Commerce',jobsReceived:28,proposalsSent:6, meetingsBooked:1,jobsWon:0,closeRate:0,funnel:[28,14,6,2,1,0,0]},
  p8:{name:'Profile #8',niche:'Copywriting',jobsReceived:31,proposalsSent:10,meetingsBooked:2,jobsWon:1,closeRate:50,funnel:[31,18,10,3,2,1,1]},
  p9:{name:'Profile #9',niche:'No-Code',jobsReceived:29,proposalsSent:9, meetingsBooked:1,jobsWon:0,closeRate:0,funnel:[29,15,9,2,1,0,0]},
  p10:{name:'Profile #10',niche:'SEO/Content',jobsReceived:22,proposalsSent:7,meetingsBooked:1,jobsWon:0,closeRate:0,funnel:[22,12,7,2,1,0,0]},
};

let activeAgent = '';
let activeProfile = '';

function applyFilters() {
  activeAgent   = document.getElementById('agentFilter').value;
  activeProfile = document.getElementById('profileFilter').value;

  // If both selected, agent takes priority (its data already has profile breakdown)
  // Reflect filter state on selects
  document.getElementById('agentFilter').classList.toggle('active-filter', !!activeAgent);
  document.getElementById('profileFilter').classList.toggle('active-filter', !!activeProfile);

  // Show/hide active bar
  updateFilterBar();

  // Get the right data slice
  const data = getFilteredData();

  // Re-render all sections
  renderOverviewKpis(data);
  renderFunnelBars(data);
  renderPipelineLive(data);
  renderTopProfiles(data);
  renderAgentLeaderboard(data);
  renderPipelineKpis(data);
  renderAgentTabKpis(data);
  renderAgentCards(data);
}

function getFilteredData() {
  if (activeAgent) return DASHBOARD_DATA[activeAgent] || DASHBOARD_DATA.all;
  if (activeProfile) {
    if (DASHBOARD_DATA[activeProfile]) return DASHBOARD_DATA[activeProfile];
    // Use fallback
    const def = PROFILE_DEFAULTS[activeProfile];
    if (def) return { ...DASHBOARD_DATA.all, ...def, jobsWonDelta:'0', proposalsPassRate: ((def.proposalsSent/def.jobsReceived)*100).toFixed(1)+'%', meetingsRate: def.proposalsSent ? ((def.meetingsBooked/def.proposalsSent)*100).toFixed(1)+'%' : '0%', closeRate: def.closeRate, agents: [], profiles:[{name:def.name,niche:def.niche,chipCls:'chip-muted',proposals:def.proposalsSent,interviewRate:((def.meetingsBooked/def.proposalsSent||0)*100).toFixed(0)+'%',interviewColor:'#d97706',won:def.jobsWon,wonColor:def.jobsWon>0?'#059669':'#dc2626'}], pipelineLive:{toDo:Math.ceil(def.jobsReceived*0.1),inProgress:Math.ceil(def.proposalsSent*0.3),meetings:def.meetingsBooked,negotiation:def.jobsWon}, agentCards:{}, agentTabKpis:{avgTime:'—',proposals:def.proposalsSent,meetingsBooked:def.meetingsBooked,wins:def.jobsWon,negRate:'—'} };
    }
  return DASHBOARD_DATA.all;
}

function updateFilterBar() {
  const bar   = document.getElementById('filterActiveBar');
  const chips = document.getElementById('filterChips');
  if (!activeAgent && !activeProfile) { bar.classList.remove('show'); return; }
  bar.classList.add('show');
  const agentNames = { ahmed:'Ahmed K.', sara:'Sara R.', mike:'Mike J.' };
  const profileNames = { p1:'Profile #1 · Design', p2:'Profile #2 · Automation', p3:'Profile #3 · SaaS Dev', p4:'Profile #4 · Backend Dev', p5:'Profile #5 · Full Stack', p6:'Profile #6 · E-Commerce', p7:'Profile #7 · AI/ML', p8:'Profile #8 · Copywriting', p9:'Profile #9 · No-Code', p10:'Profile #10 · SEO' };
  let html = '';
  if (activeAgent)   html += `<span class="filter-active-chip">👤 ${agentNames[activeAgent]} <span class="x" onclick="clearFilter('agent')">×</span></span>`;
  if (activeProfile) html += `<span class="filter-active-chip">📋 ${profileNames[activeProfile]} <span class="x" onclick="clearFilter('profile')">×</span></span>`;
  chips.innerHTML = html;
}

function clearFilter(type) {
  if (type === 'agent')   { document.getElementById('agentFilter').value = '';   activeAgent = ''; }
  if (type === 'profile') { document.getElementById('profileFilter').value = ''; activeProfile = ''; }
  document.getElementById('agentFilter').classList.toggle('active-filter', !!activeAgent);
  document.getElementById('profileFilter').classList.toggle('active-filter', !!activeProfile);
  updateFilterBar();
  const data = getFilteredData();
  renderOverviewKpis(data); renderFunnelBars(data); renderPipelineLive(data);
  renderTopProfiles(data); renderAgentLeaderboard(data); renderPipelineKpis(data);
  renderAgentTabKpis(data); renderAgentCards(data);
}

function clearAllFilters() {
  document.getElementById('agentFilter').value   = '';
  document.getElementById('profileFilter').value = '';
  activeAgent = ''; activeProfile = '';
  document.getElementById('agentFilter').classList.remove('active-filter');
  document.getElementById('profileFilter').classList.remove('active-filter');
  updateFilterBar();
  const data = DASHBOARD_DATA.all;
  renderOverviewKpis(data); renderFunnelBars(data); renderPipelineLive(data);
  renderTopProfiles(data); renderAgentLeaderboard(data); renderPipelineKpis(data);
  renderAgentTabKpis(data); renderAgentCards(data);
}

// ── RENDER FUNCTIONS ──

function renderOverviewKpis(d) {
  setEl('kpi-jobs-received',   d.jobsReceived);
  setEl('kpi-proposals-sent',  d.proposalsSent);
  setEl('kpi-meetings-booked', d.meetingsBooked);
  setEl('kpi-jobs-won',        d.jobsWon);
  setEl('kpi-close-rate',      d.closeRate + '%');
  setEl('kpi-jobs-received-delta',   (d.jobsReceivedDelta  ? '↑ ' + d.jobsReceivedDelta : '—') + ' vs last week');
  setEl('kpi-proposals-pass',  d.proposalsPassRate + ' pass rate');
  setEl('kpi-meetings-rate',   d.meetingsRate + ' booking rate');
  setEl('kpi-jobs-won-delta',  (d.jobsWonDelta ? '↑ ' + d.jobsWonDelta : '—') + ' vs last week');
}

function renderFunnelBars(d) {
  const f = d.funnel || DASHBOARD_DATA.all.funnel;
  const max = f[0];
  const ids = ['funnel-0','funnel-1','funnel-2','funnel-3','funnel-4','funnel-5','funnel-6'];
  ids.forEach((id, i) => {
    const el = document.getElementById(id);
    if (el) {
      const pct = max > 0 ? ((f[i]/max)*100).toFixed(1) : 0;
      el.style.width = pct + '%';
      el.textContent = f[i];
    }
    const num = document.getElementById(id + '-num');
    if (num) num.textContent = f[i];
  });
}

function renderPipelineLive(d) {
  const pl = d.pipelineLive || DASHBOARD_DATA.all.pipelineLive;
  setEl('pl-todo',        pl.toDo);
  setEl('pl-inprogress',  pl.inProgress);
  setEl('pl-meetings',    pl.meetings);
  setEl('pl-negotiation', pl.negotiation);
}

function renderTopProfiles(d) {
  const profiles = d.profiles || DASHBOARD_DATA.all.profiles;
  const tbody = document.getElementById('top-profiles-tbody');
  if (!tbody) return;
  tbody.innerHTML = profiles.map(p => `
    <tr>
      <td style="font-weight:700;">${p.name}</td>
      <td><span class="chip ${p.chipCls}">${p.niche}</span></td>
      <td style="font-family:'DM Mono',monospace;">${p.proposals}</td>
      <td style="color:${p.interviewColor};font-weight:600;font-family:'DM Mono',monospace;">${p.interviewRate}</td>
      <td style="font-weight:700;${p.wonColor ? 'color:'+p.wonColor+';' : ''}font-family:'DM Mono',monospace;">${p.won}</td>
    </tr>`).join('');
}

function renderAgentLeaderboard(d) {
  const agents = d.agents || DASHBOARD_DATA.all.agents;
  const container = document.getElementById('agent-leaderboard-body');
  if (!container) return;
  if (agents.length === 0) {
    container.innerHTML = '<div style="padding:20px;text-align:center;font-size:12px;color:var(--text-muted);">No agent data for this filter.</div>';
    return;
  }
  const borders = ['border-bottom:1px solid var(--border-light);','border-bottom:1px solid var(--border-light);',''];
  container.innerHTML = agents.map((a,i) => `
    <div style="display:flex;align-items:center;gap:12px;padding:12px 10px;${borders[i]||''}">
      <div style="font-size:11px;font-weight:700;color:var(--text-muted);width:18px;text-align:center;">#${a.rank}</div>
      <div class="avatar ${a.cls}">${a.init}</div>
      <div style="flex:1;"><div style="font-size:13.5px;font-weight:700;">${a.name}</div><div style="font-size:11px;color:var(--text-muted);">${a.role}</div></div>
      <div style="display:flex;gap:16px;">
        <div style="text-align:center;"><div style="font-size:16px;font-weight:700;color:var(--accent);font-family:'DM Mono',monospace;">${a.applied}</div><div style="font-size:10px;color:var(--text-muted);text-transform:uppercase;letter-spacing:.05em;">Applied</div></div>
        <div style="text-align:center;"><div style="font-size:16px;font-weight:700;color:#d97706;font-family:'DM Mono',monospace;">${a.meetings}</div><div style="font-size:10px;color:var(--text-muted);text-transform:uppercase;letter-spacing:.05em;">Mtgs</div></div>
        <div style="text-align:center;"><div style="font-size:16px;font-weight:700;${a.won>0?'color:#059669;':'color:#dc2626;'}font-family:'DM Mono',monospace;">${a.won}</div><div style="font-size:10px;color:var(--text-muted);text-transform:uppercase;letter-spacing:.05em;">Won</div></div>
      </div>
    </div>`).join('');
}

function renderPipelineKpis(d) {
  setEl('pipe-kpi-todo',       d.toDo        || 0);
  setEl('pipe-kpi-submitted',  d.submitted   || 0);
  setEl('pipe-kpi-proto',      d.protoStage  || 0);
  setEl('pipe-kpi-meeting',    d.meetingStage|| 0);
  setEl('pipe-kpi-negotiation',d.negotiation || 0);
}

function renderAgentTabKpis(d) {
  const k = d.agentTabKpis || DASHBOARD_DATA.all.agentTabKpis;
  setEl('atab-avgtime',   k.avgTime);
  setEl('atab-proposals', k.proposals);
  setEl('atab-meetings',  k.meetingsBooked);
  setEl('atab-wins',      k.wins);
  setEl('atab-negrate',   k.negRate);
}

function renderAgentCards(d) {
  const cards = d.agentCards || DASHBOARD_DATA.all.agentCards;
  const agentDefs = [
    { key:'ahmed', init:'AK', cls:'av-blue',  name:'Ahmed K.', role:'SaaS · AI/ML profiles', label:'Top Agent', labelCls:'chip-green' },
    { key:'sara',  init:'SR', cls:'av-green', name:'Sara R.',  role:'Design · Copywriting profiles', label:'Steady', labelCls:'chip-blue' },
    { key:'mike',  init:'MJ', cls:'av-amber', name:'Mike J.',  role:'Automation profiles', label:'Needs Review', labelCls:'chip-amber' },
  ];
  const container = document.getElementById('agent-cards-container');
  if (!container) return;
  const visibleAgents = Object.keys(cards).length > 0 ? agentDefs.filter(a => cards[a.key]) : agentDefs;
  const colClass = visibleAgents.length === 1 ? 'g1' : visibleAgents.length === 2 ? 'g2' : 'g3';
  container.className = colClass;
  container.innerHTML = visibleAgents.map(a => {
    const c = cards[a.key] || DASHBOARD_DATA.all.agentCards[a.key];
    if (!c) return '';
    return `<div class="agent-card">
      <div class="agent-header">
        <div class="avatar ${a.cls}">${a.init}</div>
        <div style="flex:1;"><div class="agent-name">${a.name}</div><div class="agent-role">${a.role}</div></div>
        <span class="chip ${a.labelCls}">${a.label}</span>
      </div>
      <div class="agent-body">
        <div class="agent-kpi-row">
          <div class="agent-kpi"><div class="agent-kpi-val" style="color:var(--accent);">${c.applied}</div><div class="agent-kpi-lbl">Applied</div></div>
          <div class="agent-kpi"><div class="agent-kpi-val" style="color:#d97706;">${c.meetings}</div><div class="agent-kpi-lbl">Meetings</div></div>
          <div class="agent-kpi"><div class="agent-kpi-val" style="${c.won>0?'color:#059669;':'color:#dc2626;'}">${c.won}</div><div class="agent-kpi-lbl">Won</div></div>
        </div>
        <div class="metric-row"><span class="metric-key">Avg time to apply</span><span class="metric-val ${c.timeColor}">${c.timeToApply}</span></div>
        <div class="metric-row"><span class="metric-key">Conversion rate</span><span class="metric-val ${c.convColor}">${c.convRate}</span></div>
        <div class="metric-row"><span class="metric-key">Negotiation rate</span><span class="metric-val ${c.negColor}">${c.negRate}</span></div>
        <div class="metric-row"><span class="metric-key">Bonus earned</span><span class="metric-val ${c.bonusColor}">${c.bonus}</span></div>
      </div>
    </div>`;
  }).join('');
}

function setEl(id, val) {
  const el = document.getElementById(id);
  if (el) el.textContent = val;
}

// ══════════════════════════════
//   LIVE JOB FEED ENGINE
// ══════════════════════════════
const JOB_POOL = [
  { title: "Build a SaaS Dashboard with React & Node.js", budget: "$800–$1,500", type: "Fixed", posted: "just now", client: { hireRate: "78%", spent: "$14k", rating: "4.9", country: "🇺🇸 USA", jobs: 23 }, tags: ["React","Node.js","Dashboard","SaaS"], snippet: "We need a full-stack developer to build an analytics dashboard for our SaaS product. Must have experience with Recharts and REST APIs.", profile: "Profile #3 · SaaS Dev", score: 91, niche: "saas" },
  { title: "AI Chatbot Integration for Customer Support Platform", budget: "$1,200–$2,000", type: "Fixed", posted: "just now", client: { hireRate: "64%", spent: "$8.2k", rating: "4.7", country: "🇬🇧 UK", jobs: 12 }, tags: ["Python","OpenAI","LangChain","API"], snippet: "Looking for an AI engineer to integrate a GPT-4-based chatbot into our existing customer support tool. RAG implementation preferred.", profile: "Profile #7 · AI/ML", score: 88, niche: "ai" },
  { title: "Mobile App UI/UX Redesign – Fintech", budget: "$500–$900", type: "Fixed", posted: "just now", client: { hireRate: "55%", spent: "$3.1k", rating: "4.5", country: "🇩🇪 Germany", jobs: 8 }, tags: ["Figma","UI/UX","Mobile","Fintech"], snippet: "Redesign the UI for our mobile banking app. We want a clean, modern interface with improved user flow and accessibility.", profile: "Profile #1 · Design", score: 72, niche: "design" },
  { title: "n8n Automation Workflow for Lead Generation", budget: "$300–$600", type: "Fixed", posted: "just now", client: { hireRate: "43%", spent: "$890", rating: "4.2", country: "🇦🇺 Australia", jobs: 5 }, tags: ["n8n","Automation","Zapier","CRM"], snippet: "Set up an automated lead generation and nurturing workflow using n8n. Integrate with HubSpot and Slack notifications.", profile: "Profile #5 · Automation", score: 65, niche: "automation" },
  { title: "Full Stack Developer for B2B Marketplace Platform", budget: "$2,000–$4,000", type: "Fixed", posted: "just now", client: { hireRate: "82%", spent: "$31k", rating: "5.0", country: "🇺🇸 USA", jobs: 47 }, tags: ["React","PostgreSQL","Node.js","AWS"], snippet: "Building a B2B procurement marketplace. Need experienced full-stack developer. Long-term engagement possible after initial milestone.", profile: "Profile #3 · SaaS Dev", score: 95, niche: "saas" },
  { title: "Machine Learning Model for Churn Prediction", budget: "$1,000–$1,800", type: "Fixed", posted: "just now", client: { hireRate: "71%", spent: "$12k", rating: "4.8", country: "🇨🇦 Canada", jobs: 19 }, tags: ["Python","scikit-learn","ML","Data Science"], snippet: "Build and train a churn prediction model using our historical customer data. Deliverable includes model, API endpoint, and documentation.", profile: "Profile #7 · AI/ML", score: 85, niche: "ai" },
  { title: "WordPress Site Redesign with Custom Theme", budget: "$200–$400", type: "Fixed", posted: "just now", client: { hireRate: "29%", spent: "$420", rating: "3.8", country: "🇮🇳 India", jobs: 3 }, tags: ["WordPress","PHP","CSS","Elementor"], snippet: "Redesign our company website using WordPress. Client has low budget and unverified payment.", profile: "Profile #8 · Copywriting", score: 28, niche: "other" },
  { title: "Webflow Landing Page for SaaS Product Launch", budget: "$600–$1,000", type: "Fixed", posted: "just now", client: { hireRate: "67%", spent: "$5.6k", rating: "4.7", country: "🇳🇱 Netherlands", jobs: 14 }, tags: ["Webflow","UI Design","SaaS","CRO"], snippet: "Design and build a high-converting landing page for our SaaS product launch. Must have experience with CRO best practices and Webflow.", profile: "Profile #1 · Design", score: 79, niche: "design" },
  { title: "LLM Fine-tuning Pipeline – Legal Documents", budget: "$1,500–$3,000", type: "Fixed", posted: "just now", client: { hireRate: "89%", spent: "$44k", rating: "5.0", country: "🇺🇸 USA", jobs: 61 }, tags: ["Python","LLM","Fine-tuning","NLP"], snippet: "Set up a fine-tuning pipeline for legal document summarization. We have a labeled dataset ready. Must have HuggingFace experience.", profile: "Profile #7 · AI/ML", score: 97, niche: "ai" },
  { title: "REST API Development for Mobile App Backend", budget: "$700–$1,200", type: "Fixed", posted: "just now", client: { hireRate: "58%", spent: "$7.8k", rating: "4.6", country: "🇸🇬 Singapore", jobs: 16 }, tags: ["Node.js","Express","MongoDB","API"], snippet: "Build a REST API to support our iOS and Android app. Must handle authentication, real-time notifications, and file uploads.", profile: "Profile #4 · Backend Dev", score: 76, niche: "backend" },
  { title: "Ecommerce SEO Audit and Content Strategy", budget: "$150–$300", type: "Fixed", posted: "just now", client: { hireRate: "18%", spent: "$210", rating: "3.5", country: "🇵🇰 Pakistan", jobs: 2 }, tags: ["SEO","Content","Ecommerce"], snippet: "Low budget SEO audit for ecommerce site. Client has no prior spend history and unverified payment method.", profile: "Profile #10 · SEO", score: 22, niche: "seo" },
  { title: "CRM Integration – Salesforce + Zapier Workflows", budget: "$400–$800", type: "Fixed", posted: "just now", client: { hireRate: "75%", spent: "$9.3k", rating: "4.9", country: "🇺🇸 USA", jobs: 28 }, tags: ["Salesforce","Zapier","CRM","Automation"], snippet: "Set up bidirectional sync between Salesforce and our internal tools. Also need Zapier workflows to automate sales team tasks.", profile: "Profile #5 · Automation", score: 82, niche: "automation" },
  { title: "Brand Identity Design for Tech Startup", budget: "$800–$1,400", type: "Fixed", posted: "just now", client: { hireRate: "61%", spent: "$6.1k", rating: "4.8", country: "🇸🇪 Sweden", jobs: 11 }, tags: ["Branding","Logo","Figma","Identity"], snippet: "Design a complete brand identity for our AI startup including logo, color system, typography, and brand guidelines document.", profile: "Profile #1 · Design", score: 80, niche: "design" },
  { title: "No-Code Bubble App for Client Portal", budget: "$500–$900", type: "Fixed", posted: "just now", client: { hireRate: "34%", spent: "$1.2k", rating: "4.0", country: "🇫🇷 France", jobs: 6 }, tags: ["Bubble","No-Code","Client Portal","MVP"], snippet: "Build a client portal MVP using Bubble.io. Must support user login, file uploads, messaging, and invoice viewing.", profile: "Profile #9 · No-Code", score: 54, niche: "nocode" },
  { title: "Senior React Developer – Ongoing Contract", budget: "$50–$80/hr", type: "Hourly", posted: "just now", client: { hireRate: "91%", spent: "$89k", rating: "5.0", country: "🇺🇸 USA", jobs: 112 }, tags: ["React","TypeScript","Redux","AWS"], snippet: "Looking for a senior React developer for ongoing contract work on our enterprise SaaS platform. 20+ hrs/week. Long-term.", profile: "Profile #3 · SaaS Dev", score: 98, niche: "saas" },
];

let feedJobs = [];
let feedPaused = false;
let feedCountToday = 0, feedCountAccepted = 0, feedCountRejected = 0, feedJobTimes = [];
let feedInterval = null;
let feedTickerLog = [];

function startFeed() {
  // Seed with a few initial jobs
  const seedCount = 4;
  const shuffled = [...JOB_POOL].sort(() => Math.random() - 0.5);
  for (let i = 0; i < seedCount; i++) {
    const job = { ...shuffled[i], id: Date.now() + i, timestamp: new Date(Date.now() - (seedCount - i) * 45000), status: 'pending', isNew: false };
    feedJobs.unshift(job);
    feedCountToday++;
  }
  renderFeedList();
  renderOverviewFeedTable();
  updateFeedStats();

  // Auto-generate new jobs every 8–18 seconds
  scheduleNextJob();
}

function scheduleNextJob() {
  if (feedInterval) clearTimeout(feedInterval);
  const delay = (8 + Math.random() * 10) * 1000;
  feedInterval = setTimeout(() => {
    if (!feedPaused) addNewJob();
    scheduleNextJob();
  }, delay);
}

function addNewJob() {
  const job = { ...JOB_POOL[Math.floor(Math.random() * JOB_POOL.length)], id: Date.now(), timestamp: new Date(), status: 'pending', isNew: true };
  feedJobs.unshift(job);
  if (feedJobs.length > 50) feedJobs.pop();
  feedCountToday++;
  feedJobTimes.push(Date.now());
  // Keep only last 10 min for rate calc
  const tenMin = Date.now() - 600000;
  feedJobTimes = feedJobTimes.filter(t => t > tenMin);

  addTickerEntry(job);
  renderFeedList();
  renderOverviewFeedTable();
  updateFeedStats();

  // Update nav badge
  const pending = feedJobs.filter(j => j.status === 'pending').length;
  const badge = document.getElementById('feedBadge');
  if (badge) { badge.textContent = pending > 0 ? pending : '0'; }

  // Clear "new" state after 3s
  setTimeout(() => {
    const j = feedJobs.find(x => x.id === job.id);
    if (j) { j.isNew = false; renderFeedList(); }
  }, 3000);
}

function renderFeedList() {
  const list = document.getElementById('feedList');
  const empty = document.getElementById('feedEmpty');
  if (!list) return;
  if (feedJobs.length === 0) { list.innerHTML = ''; if(empty) empty.style.display = 'block'; return; }
  if(empty) empty.style.display = 'none';

  list.innerHTML = feedJobs.map(job => {
    const scoreColor = job.score >= 80 ? '#059669' : job.score >= 55 ? '#d97706' : '#dc2626';
    const scoreBg    = job.score >= 80 ? '#ecfdf5' : job.score >= 55 ? '#fffbeb' : '#fef2f2';
    const circumference = 2 * Math.PI * 18;
    const dashOffset = circumference - (job.score / 100) * circumference;

    let statusClass = 'pending', actionBtns = '';
    if (job.status === 'accepted') {
      statusClass = 'accepted';
      actionBtns = `<span class="chip chip-green" style="font-size:10px;">✓ Accepted</span>`;
    } else if (job.status === 'rejected') {
      statusClass = 'rejected';
      actionBtns = `<span class="chip chip-red" style="font-size:10px;">✗ Rejected</span>`;
    } else {
      actionBtns = `
        <div class="feed-action-row">
          <button class="feed-btn feed-btn-accept" onclick="acceptJob(${job.id})">Accept</button>
          <button class="feed-btn feed-btn-reject" onclick="rejectJob(${job.id})">Reject</button>
        </div>`;
    }

    const timeAgo = getTimeAgo(job.timestamp);

    return `<div class="feed-item ${statusClass} ${job.isNew ? 'new-item' : ''}" id="job-${job.id}">
      ${job.isNew ? '<div class="feed-new-pulse"></div>' : ''}
      <div class="feed-score-ring" style="color:${scoreColor};background:${scoreBg};">
        <svg viewBox="0 0 40 40"><circle cx="20" cy="20" r="18" fill="none" stroke="var(--border)" stroke-width="3"/><circle cx="20" cy="20" r="18" fill="none" stroke="${scoreColor}" stroke-width="3" stroke-dasharray="${circumference}" stroke-dashoffset="${dashOffset}" stroke-linecap="round"/></svg>
        <span>${job.score}</span>
      </div>
      <div class="feed-body">
        <div class="feed-title">${job.title}</div>
        <div class="feed-meta">
          <span class="feed-meta-item"><strong>${job.budget}</strong></span>
          <span style="color:var(--border);">·</span>
          <span class="feed-meta-item">${job.type}</span>
          <span style="color:var(--border);">·</span>
          <span class="feed-meta-item">${job.client.country}</span>
          <span style="color:var(--border);">·</span>
          <span class="feed-meta-item">Hire rate: <strong>${job.client.hireRate}</strong></span>
          <span style="color:var(--border);">·</span>
          <span class="feed-meta-item">Spent: <strong>${job.client.spent}</strong></span>
          <span style="color:var(--border);">·</span>
          <span class="feed-meta-item">⭐ ${job.client.rating}</span>
        </div>
        <div class="feed-tags">${job.tags.map(t => `<span class="feed-tag">${t}</span>`).join('')}<span class="feed-tag" style="background:var(--accent-light);color:var(--accent);border-color:var(--accent-mid);">${job.profile}</span></div>
        <div class="feed-snippet">${job.snippet}</div>
      </div>
      <div class="feed-actions">
        <div class="feed-time">${timeAgo}</div>
        ${actionBtns}
      </div>
    </div>`;
  }).join('');
}

function acceptJob(id) {
  const job = feedJobs.find(j => j.id === id);
  if (job) { job.status = 'accepted'; feedCountAccepted++; }
  addTickerEntry({ ...feedJobs.find(j=>j.id===id), action: 'accepted' });
  renderFeedList(); updateFeedStats(); updateNavBadge();
}

function rejectJob(id) {
  const job = feedJobs.find(j => j.id === id);
  if (job) { job.status = 'rejected'; feedCountRejected++; }
  addTickerEntry({ ...feedJobs.find(j=>j.id===id), action: 'rejected' });
  renderFeedList(); updateFeedStats(); updateNavBadge();
}

function updateNavBadge() {
  const pending = feedJobs.filter(j => j.status === 'pending').length;
  const badge = document.getElementById('feedBadge');
  if (badge) badge.textContent = pending > 0 ? pending : '0';
}

function updateFeedStats() {
  const el = id => document.getElementById(id);
  if (el('feed-count-today'))    el('feed-count-today').textContent    = feedCountToday;
  if (el('feed-count-accepted')) el('feed-count-accepted').textContent = feedCountAccepted;
  if (el('feed-count-rejected')) el('feed-count-rejected').textContent = feedCountRejected;
  const pending = feedJobs.filter(j => j.status === 'pending').length;
  if (el('feed-count-pending'))  el('feed-count-pending').textContent  = pending;

  // Avg score
  const scores = feedJobs.map(j => j.score);
  const avg = scores.length ? Math.round(scores.reduce((a,b) => a+b, 0) / scores.length) : null;
  if (el('feed-avg-score')) el('feed-avg-score').textContent = avg ? avg : '—';

  // Jobs/hour rate
  const tenMin = Date.now() - 600000;
  const recentCount = feedJobTimes.filter(t => t > tenMin).length;
  const rate = Math.round(recentCount * 6); // extrapolate to per-hour
  if (el('feedRateVal')) el('feedRateVal').textContent = rate > 0 ? rate + '/hr' : '—';
}

function addTickerEntry(job) {
  const action = job.action;
  const dotColor = action === 'accepted' ? '#059669' : action === 'rejected' ? '#dc2626' : '#1a56db';
  const text = action === 'accepted' ? `✓ Accepted: ${job.title.substring(0,35)}…` :
               action === 'rejected' ? `✗ Rejected: ${job.title.substring(0,35)}…` :
               `New job: ${job.title.substring(0,38)}…`;
  feedTickerLog.unshift({ dot: dotColor, text, time: getTimeAgo(new Date()) });
  if (feedTickerLog.length > 20) feedTickerLog.pop();

  const ticker = document.getElementById('feedTicker');
  if (ticker) {
    ticker.innerHTML = feedTickerLog.map(e =>
      `<div class="feed-ticker-row">
        <div class="feed-ticker-dot" style="background:${e.dot};"></div>
        <div class="feed-ticker-text">${e.text}</div>
        <div class="feed-ticker-time">${e.time}</div>
      </div>`
    ).join('');
  }
}

function toggleFeedPause() {
  feedPaused = !feedPaused;
  const btn = document.getElementById('feedPauseBtn');
  if (btn) {
    btn.textContent = feedPaused ? '▶ Resume' : '⏸ Pause';
    btn.classList.toggle('paused', feedPaused);
  }
}

function clearFeed() {
  feedJobs = [];
  feedCountToday = 0; feedCountAccepted = 0; feedCountRejected = 0; feedJobTimes = [];
  feedTickerLog = [];
  renderFeedList(); updateFeedStats();
  document.getElementById('feedTicker').innerHTML = '';
  updateNavBadge();
}

function getTimeAgo(date) {
  const diff = Math.floor((Date.now() - new Date(date).getTime()) / 1000);
  if (diff < 5)  return 'just now';
  if (diff < 60) return `${diff}s ago`;
  if (diff < 3600) return `${Math.floor(diff/60)}m ago`;
  return `${Math.floor(diff/3600)}h ago`;
}

// Re-render time labels every 30s
setInterval(() => {
  if (feedJobs.length > 0) renderFeedList();
}, 30000);

// Start feed when page loads
window.addEventListener('DOMContentLoaded', () => {
  startFeed();
});

// ══════════════════════════════
//   DATE RANGE PICKER ENGINE
// ══════════════════════════════
const MONTHS = ['January','February','March','April','May','June','July','August','September','October','November','December'];
const MONTHS_SHORT = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
const DAYS = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];

let drpState = {
  leftYear: 2026, leftMonth: 0,   // Jan 2026
  rightYear: 2026, rightMonth: 1,  // Feb 2026
  rangeStart: new Date(2026, 0, 28),
  rangeEnd:   new Date(2026, 1, 26),
  hoverDate: null,
  activePreset: 'last30'
};

function toggleDatePicker() {
  const overlay = document.getElementById('drpOverlay');
  const trigger = document.getElementById('drpTrigger');
  const isOpen = overlay.classList.contains('open');
  if (isOpen) { closeDatePicker(); return; }
  overlay.classList.add('open');
  trigger.classList.add('open');
  syncMonthsToRange();
  renderBothCals();
  syncInputs();
}

function closeDatePicker() {
  document.getElementById('drpOverlay').classList.remove('open');
  document.getElementById('drpTrigger').classList.remove('open');
}

function handleOverlayClick(e) {
  if (e.target === document.getElementById('drpOverlay')) closeDatePicker();
}

function syncMonthsToRange() {
  // Show month of start in left, month after in right
  if (drpState.rangeStart) {
    drpState.leftYear  = drpState.rangeStart.getFullYear();
    drpState.leftMonth = drpState.rangeStart.getMonth();
    let rm = drpState.leftMonth + 1, ry = drpState.leftYear;
    if (rm > 11) { rm = 0; ry++; }
    drpState.rightMonth = rm; drpState.rightYear = ry;
  }
}

function navigateCal(dir) {
  // dir: -1 prev, +1 next — moves both months together
  drpState.leftMonth += dir;
  if (drpState.leftMonth < 0)  { drpState.leftMonth = 11; drpState.leftYear--;  }
  if (drpState.leftMonth > 11) { drpState.leftMonth = 0;  drpState.leftYear++;  }
  drpState.rightMonth = drpState.leftMonth + 1;
  drpState.rightYear  = drpState.leftYear;
  if (drpState.rightMonth > 11) { drpState.rightMonth = 0; drpState.rightYear++; }
  renderBothCals();
}

function changeMonth(side, val) {
  val = parseInt(val);
  if (side === 'left') {
    drpState.leftMonth = val;
    drpState.rightMonth = val + 1; drpState.rightYear = drpState.leftYear;
    if (drpState.rightMonth > 11) { drpState.rightMonth = 0; drpState.rightYear++; }
  } else {
    drpState.rightMonth = val;
    drpState.leftMonth = val - 1; drpState.leftYear = drpState.rightYear;
    if (drpState.leftMonth < 0) { drpState.leftMonth = 11; drpState.leftYear--; }
  }
  renderBothCals();
}

function changeYear(side, val) {
  val = parseInt(val);
  if (side === 'left') {
    drpState.leftYear = val;
    drpState.rightMonth = drpState.leftMonth + 1; drpState.rightYear = val;
    if (drpState.rightMonth > 11) { drpState.rightMonth = 0; drpState.rightYear = val + 1; }
  } else {
    drpState.rightYear = val;
    drpState.leftMonth = drpState.rightMonth - 1; drpState.leftYear = val;
    if (drpState.leftMonth < 0) { drpState.leftMonth = 11; drpState.leftYear = val - 1; }
  }
  renderBothCals();
}

function renderBothCals() {
  renderCal('left',  drpState.leftYear,  drpState.leftMonth);
  renderCal('right', drpState.rightYear, drpState.rightMonth);
}

function renderCal(side, year, month) {
  const container = document.getElementById(side === 'left' ? 'drpCalLeft' : 'drpCalRight');
  const today = new Date(); today.setHours(0,0,0,0);
  const firstDay = new Date(year, month, 1).getDay();
  const daysInMonth = new Date(year, month + 1, 0).getDate();

  // Build year options
  const yearOpts = Array.from({length: 10}, (_,i) => 2020 + i)
    .map(y => `<option value="${y}" ${y===year?'selected':''}>${y}</option>`).join('');

  let html = `<div class="drp-cal-header">
    <button class="drp-cal-nav ${side==='left'?'':'hidden'}" onclick="navigateCal(-1)">&#8249;</button>
    <div class="drp-cal-month-year">
      <div class="drp-sel-wrap"><select class="drp-cal-select" onchange="changeMonth('${side}',this.value)">
        ${MONTHS.map((m,i)=>`<option value="${i}" ${i===month?'selected':''}>${m}</option>`).join('')}
      </select></div>
      <div class="drp-sel-wrap"><select class="drp-cal-select" onchange="changeYear('${side}',this.value)">
        ${yearOpts}
      </select></div>
    </div>
    <button class="drp-cal-nav ${side==='right'?'':'hidden'}" onclick="navigateCal(1)">&#8250;</button>
  </div>`;

  html += `<table class="drp-grid"><thead><tr>`;
  DAYS.forEach(d => { html += `<th>${d}</th>`; });
  html += `</tr></thead><tbody>`;

  let dayCount = 1;
  for (let row = 0; row < 6; row++) {
    if (dayCount > daysInMonth) break;
    html += '<tr>';
    for (let col = 0; col < 7; col++) {
      const cellNum = row * 7 + col;
      if (cellNum < firstDay || dayCount > daysInMonth) {
        html += '<td><div class="drp-day empty"></div></td>';
      } else {
        const d = new Date(year, month, dayCount); d.setHours(0,0,0,0);
        const ts = d.getTime();
        const s = drpState.rangeStart ? new Date(drpState.rangeStart).setHours(0,0,0,0) : null;
        const e = drpState.rangeEnd   ? new Date(drpState.rangeEnd).setHours(0,0,0,0)   : null;
        const h = drpState.hoverDate  ? new Date(drpState.hoverDate).setHours(0,0,0,0)  : null;
        const effectiveEnd = e || (s && h ? Math.max(s, h) : null);
        const isStart    = s && ts === s;
        const isEnd      = effectiveEnd && ts === effectiveEnd;
        const inRange    = s && effectiveEnd && ts > Math.min(s, effectiveEnd) && ts < Math.max(s, effectiveEnd);
        const isToday    = ts === today.getTime();
        let cls = 'drp-day';
        if (isStart) cls += ' range-start';
        if (isEnd)   cls += ' range-end';
        if (inRange && !isStart && !isEnd) cls += ' in-range';
        if (isToday) cls += ' today';
        html += `<td><div class="${cls}"
          onclick="selectDay(${year},${month},${dayCount})"
          onmouseenter="hoverDay(${year},${month},${dayCount})"
          onmouseleave="clearHover()">${dayCount}</div></td>`;
        dayCount++;
      }
    }
    html += '</tr>';
  }
  html += '</tbody></table>';
  container.innerHTML = html;
}

function selectDay(y, m, d) {
  const clicked = new Date(y, m, d); clicked.setHours(0,0,0,0);
  const s = drpState.rangeStart;
  const e = drpState.rangeEnd;
  // If no start, or both already set → start new selection
  if (!s || (s && e)) {
    drpState.rangeStart = clicked;
    drpState.rangeEnd   = null;
    drpState.hoverDate  = null;
    drpState.activePreset = 'custom';
    updatePresetHighlight();
  } else {
    // Have start, set end
    if (clicked < s) {
      drpState.rangeEnd   = new Date(s);
      drpState.rangeStart = clicked;
    } else {
      drpState.rangeEnd = clicked;
    }
    drpState.hoverDate = null;
    drpState.activePreset = 'custom';
    updatePresetHighlight();
  }
  syncInputs();
  renderBothCals();
}

function hoverDay(y, m, d) {
  if (drpState.rangeStart && !drpState.rangeEnd) {
    drpState.hoverDate = new Date(y, m, d);
    renderBothCals();
  }
}

function clearHover() {
  if (drpState.hoverDate) { drpState.hoverDate = null; renderBothCals(); }
}

function syncInputs() {
  const fmt = d => d ? `${d.getDate()} ${MONTHS_SHORT[d.getMonth()]} ${d.getFullYear()}` : '';
  document.getElementById('drpInputStart').value = fmt(drpState.rangeStart);
  document.getElementById('drpInputEnd').value   = fmt(drpState.rangeEnd);
}

function handleInputChange() {
  // Allow manual text entry (basic parse)
}

function applyDateRange() {
  if (!drpState.rangeStart || !drpState.rangeEnd) return;
  const fmt = d => `${d.getDate()} ${MONTHS_SHORT[d.getMonth()]} ${d.getFullYear()}`;
  const labelMap = {
    today:'Today', yesterday:'Yesterday', last7:'Last 7 days', last14:'Last 14 days',
    last28:'Last 28 days', last30:'Last 30 days', this_week:'This week', last_week:'Last week',
    this_month:'This month', last_month:'Last month', this_quarter:'This quarter',
    last_quarter:'Last quarter', this_year:'This year', last_year:'Last year', maximum:'Maximum'
  };
  let label = '';
  if (drpState.activePreset && drpState.activePreset !== 'custom' && labelMap[drpState.activePreset]) {
    label = labelMap[drpState.activePreset] + ': ' + fmt(drpState.rangeStart) + ' – ' + fmt(drpState.rangeEnd);
  } else {
    label = fmt(drpState.rangeStart) + ' – ' + fmt(drpState.rangeEnd);
  }
  document.getElementById('drpLabel').textContent = label;
  closeDatePicker();
}

// ── PRESETS ──
const PRESETS = {
  today: () => { const d = new Date(); d.setHours(0,0,0,0); return [d, new Date(d)]; },
  yesterday: () => {
    const d = new Date(); d.setHours(0,0,0,0); d.setDate(d.getDate()-1);
    return [d, new Date(d)];
  },
  today_yesterday: () => {
    const e = new Date(); e.setHours(0,0,0,0);
    const s = new Date(e); s.setDate(s.getDate()-1);
    return [s, e];
  },
  last7: () => {
    const e = new Date(); e.setHours(0,0,0,0); e.setDate(e.getDate()-1);
    const s = new Date(e); s.setDate(s.getDate()-6);
    return [s, e];
  },
  last14: () => {
    const e = new Date(); e.setHours(0,0,0,0); e.setDate(e.getDate()-1);
    const s = new Date(e); s.setDate(s.getDate()-13);
    return [s, e];
  },
  last28: () => {
    const e = new Date(); e.setHours(0,0,0,0); e.setDate(e.getDate()-1);
    const s = new Date(e); s.setDate(s.getDate()-27);
    return [s, e];
  },
  last30: () => {
    const e = new Date(); e.setHours(0,0,0,0);
    const s = new Date(e); s.setDate(s.getDate()-29);
    return [s, e];
  },
  this_week: () => {
    const now = new Date(); now.setHours(0,0,0,0);
    const s = new Date(now); s.setDate(s.getDate() - s.getDay());
    return [s, now];
  },
  last_week: () => {
    const now = new Date(); now.setHours(0,0,0,0);
    const e = new Date(now); e.setDate(e.getDate() - e.getDay() - 1);
    const s = new Date(e); s.setDate(s.getDate() - 6);
    return [s, e];
  },
  this_month: () => {
    const now = new Date(); now.setHours(0,0,0,0);
    const s = new Date(now.getFullYear(), now.getMonth(), 1);
    return [s, now];
  },
  last_month: () => {
    const now = new Date();
    const e = new Date(now.getFullYear(), now.getMonth(), 0);
    const s = new Date(now.getFullYear(), now.getMonth()-1, 1);
    return [s, e];
  },
  this_quarter: () => {
    const now = new Date(); now.setHours(0,0,0,0);
    const q = Math.floor(now.getMonth()/3);
    const s = new Date(now.getFullYear(), q*3, 1);
    return [s, now];
  },
  last_quarter: () => {
    const now = new Date();
    const q = Math.floor(now.getMonth()/3);
    const sq = q === 0 ? 3 : q-1;
    const sy = q === 0 ? now.getFullYear()-1 : now.getFullYear();
    const s = new Date(sy, sq*3, 1);
    const e = new Date(sy, sq*3+3, 0);
    return [s, e];
  },
  this_year: () => {
    const now = new Date(); now.setHours(0,0,0,0);
    const s = new Date(now.getFullYear(), 0, 1);
    return [s, now];
  },
  last_year: () => {
    const y = new Date().getFullYear()-1;
    return [new Date(y,0,1), new Date(y,11,31)];
  },
  maximum: () => {
    const s = new Date(2020, 0, 1);
    const e = new Date(); e.setHours(0,0,0,0);
    return [s, e];
  }
};

function selectPreset(key) {
  if (!PRESETS[key]) return;
  const [s, e] = PRESETS[key]();
  drpState.rangeStart = s;
  drpState.rangeEnd   = e;
  drpState.activePreset = key;
  syncMonthsToRange();
  renderBothCals();
  syncInputs();
  updatePresetHighlight();
}

function updatePresetHighlight() {
  document.querySelectorAll('.drp-preset').forEach(el => el.classList.remove('selected'));
  if (drpState.activePreset && drpState.activePreset !== 'custom') {
    document.querySelectorAll('.drp-preset').forEach(el => {
      if (el.getAttribute('onclick') && el.getAttribute('onclick').includes("'" + drpState.activePreset + "'")) {
        el.classList.add('selected');
      }
    });
  }
}


// ── OVERVIEW MINI FEED TABLE ──
function renderOverviewFeedTable() {
  const tbody = document.getElementById('overview-feed-tbody');
  if (!tbody) return;

  const jobs = feedJobs.slice(0, 8); // show latest 8
  if (jobs.length === 0) {
    tbody.innerHTML = '<tr><td colspan="7" style="text-align:center;color:var(--text-muted);padding:24px;font-size:12px;">Waiting for jobs…</td></tr>';
    return;
  }

  tbody.innerHTML = jobs.map(job => {
    const scoreColor = job.score >= 80 ? '#059669' : job.score >= 55 ? '#d97706' : '#dc2626';
    const scoreBg    = job.score >= 80 ? 'var(--green-light)' : job.score >= 55 ? 'var(--amber-light)' : 'var(--red-light)';

    let statusHtml = '';
    if (job.status === 'accepted') {
      statusHtml = '<span class="chip chip-green" style="font-size:10px;">✓ Accepted</span>';
    } else if (job.status === 'rejected') {
      statusHtml = '<span class="chip chip-red" style="font-size:10px;">✗ Rejected</span>';
    } else {
      statusHtml = `<div style="display:flex;gap:5px;">
        <button class="feed-btn feed-btn-accept" style="padding:3px 9px;font-size:11px;" onclick="acceptJob(${job.id});renderOverviewFeedTable()">Accept</button>
        <button class="feed-btn feed-btn-reject" style="padding:3px 9px;font-size:11px;" onclick="rejectJob(${job.id});renderOverviewFeedTable()">Reject</button>
      </div>`;
    }

    const rowStyle = job.status === 'rejected' ? 'opacity:0.45;' : job.isNew ? 'background:var(--accent-light);' : '';

    return `<tr style="${rowStyle}">
      <td style="font-weight:600;max-width:220px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">${job.title}</td>
      <td style="font-family:'DM Mono',monospace;font-size:12px;white-space:nowrap;">${job.budget}</td>
      <td><span class="chip chip-blue" style="font-size:10px;">${job.profile}</span></td>
      <td style="font-size:12px;">
        <span style="color:var(--text-muted);">${job.client.country}</span>
        <span style="color:var(--border);margin:0 4px;">·</span>
        <span style="font-weight:600;color:${job.client.hireRate >= '70' ? '#059669' : 'var(--text-secondary)'};">${job.client.hireRate}</span>
        <span style="color:var(--text-muted);font-size:11px;"> hire</span>
      </td>
      <td>
        <span style="display:inline-flex;align-items:center;justify-content:center;width:32px;height:22px;border-radius:5px;font-size:11px;font-weight:700;background:${scoreBg};color:${scoreColor};font-family:'DM Mono',monospace;">${job.score}</span>
      </td>
      <td style="font-size:11px;color:var(--text-muted);font-family:'DM Mono',monospace;white-space:nowrap;">${getTimeAgo(job.timestamp)}</td>
      <td>${statusHtml}</td>
    </tr>`;
  }).join('');
}

// ── THEME TOGGLE ──
const html = document.documentElement;
const toggleBtn = document.getElementById('themeToggle');

// Load saved preference or default to light
const savedTheme = localStorage.getItem('agencyTheme') || 'light';
html.setAttribute('data-theme', savedTheme);

toggleBtn.addEventListener('click', () => {
  const current = html.getAttribute('data-theme');
  const next = current === 'dark' ? 'light' : 'dark';
  html.setAttribute('data-theme', next);
  try { localStorage.setItem('agencyTheme', next); } catch(e) {}
});
</script>

<!-- ══ DATE RANGE PICKER OVERLAY ══ -->
<div class="drp-overlay" id="drpOverlay" onclick="handleOverlayClick(event)">
  <div class="drp-popup" onclick="event.stopPropagation()">
    <!-- Presets -->
    <div class="drp-presets">
      <div class="drp-presets-title">Recently used</div>
      <div class="drp-preset" onclick="selectPreset('today')"><div class="drp-radio"></div>Today</div>
      <div class="drp-preset" onclick="selectPreset('yesterday')"><div class="drp-radio"></div>Yesterday</div>
      <div class="drp-preset" onclick="selectPreset('maximum')"><div class="drp-radio"></div>Maximum</div>
      <div class="drp-preset-sep"></div>
      <div class="drp-preset" onclick="selectPreset('today')"><div class="drp-radio"></div>Today</div>
      <div class="drp-preset" onclick="selectPreset('yesterday')"><div class="drp-radio"></div>Yesterday</div>
      <div class="drp-preset" onclick="selectPreset('today_yesterday')"><div class="drp-radio"></div>Today and yesterday</div>
      <div class="drp-preset" onclick="selectPreset('last7')"><div class="drp-radio"></div>Last 7 days</div>
      <div class="drp-preset" onclick="selectPreset('last14')"><div class="drp-radio"></div>Last 14 days</div>
      <div class="drp-preset" onclick="selectPreset('last28')"><div class="drp-radio"></div>Last 28 days</div>
      <div class="drp-preset selected" id="preset-last30" onclick="selectPreset('last30')"><div class="drp-radio"></div>Last 30 days</div>
      <div class="drp-preset" onclick="selectPreset('this_week')"><div class="drp-radio"></div>This week</div>
      <div class="drp-preset" onclick="selectPreset('last_week')"><div class="drp-radio"></div>Last week</div>
      <div class="drp-preset" onclick="selectPreset('this_month')"><div class="drp-radio"></div>This month</div>
      <div class="drp-preset" onclick="selectPreset('last_month')"><div class="drp-radio"></div>Last month</div>
      <div class="drp-preset" onclick="selectPreset('this_quarter')"><div class="drp-radio"></div>This quarter</div>
      <div class="drp-preset" onclick="selectPreset('last_quarter')"><div class="drp-radio"></div>Last quarter</div>
      <div class="drp-preset" onclick="selectPreset('this_year')"><div class="drp-radio"></div>This year</div>
      <div class="drp-preset" onclick="selectPreset('last_year')"><div class="drp-radio"></div>Last year</div>
    </div>
    <!-- Right: Calendars + Footer -->
    <div class="drp-right">
      <div class="drp-calendars">
        <div class="drp-cal" id="drpCalLeft"></div>
        <div class="drp-cal" id="drpCalRight"></div>
      </div>
      <div class="drp-footer">
        <div class="drp-inputs">
          <input class="drp-input" id="drpInputStart" type="text" placeholder="Start date" oninput="handleInputChange()" />
          <span class="drp-sep">—</span>
          <input class="drp-input" id="drpInputEnd" type="text" placeholder="End date" oninput="handleInputChange()" />
        </div>
        <div style="display:flex;align-items:center;gap:16px;">
          <span class="drp-tz">Dates shown in local time</span>
          <div class="drp-actions">
            <button class="drp-btn-cancel" onclick="closeDatePicker()">Cancel</button>
            <button class="drp-btn-update" onclick="applyDateRange()">Update</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
